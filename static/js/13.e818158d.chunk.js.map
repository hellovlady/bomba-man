{"version":3,"sources":["containers/WaitingRoom/WaitingRoom.tsx","routes/pages/WaitingRoom.tsx","animations.tsx","utils/index.ts","containers/Game/components/TileIcon.tsx","containers/RoomCreator/icons.tsx","containers/Game/components/DeadCharacter.tsx","containers/Game/components/PowerUp/icons.tsx","containers/Game/components/SpriteCharacter.tsx","containers/Game/components/character-shadow.png","containers/Game/components/character-skin-default.png","store/firebase/hooks/useFirebaseUtils.tsx","components/NoAccess/NoAccess.tsx","containers/RoomCreator/utils.tsx","utils/material-ui.ts","store/redux/reducers/firebase/selectors.tsx","store/firebase/hooks/useWatchOnlineGame.tsx","utils/random-name-generator.ts","store/firebase/hooks/useOnlineGameActions.tsx","containers/WaitingRoom/PlayerDisplay.tsx","hooks/useBeforeUnload.tsx","hooks/useOnPlayerExitOnline.tsx"],"names":["WaitingRoom","gameId","push","useHistory","useWatchOnlineGame","pending","error","game","isReady","onPlayerJoin","onStartGame","npcPlayerIds","useRef","useState","canStart","setCanStart","currentOnlinePlayerId","setCurrentOnlinePlayerId","useOnPlayerExitOnline","useEffect","gamePlayers","playerKeys","Object","keys","playerCount","length","started","BASE_PATH","message","currentPlayerNumbers","map","key","Number","replace","openPlayerNumbers","filter","openNumber","includes","newPlayerId","Math","min","playerId","current","window","location","link","origin","pathname","Spacer","style","color","theme","palette","info","PlayerDisplay","players","WaitingRoomPage","id","match","params","PageContainer","overflow","bounceAnimation","withOpacity","keyframes","ghostAnimation","size","ceil","sleep","duration","Promise","r","setTimeout","wrapPreventFocusLock","cb","e","currentTarget","blur","doesNotExist","value","undefined","findEnumKeyFromValue","enumerable","values","indexOf","TileIcon","styled","div","$size","$animationDelay","$top","$left","css","PowerUpIcon","props","icon","faFistRaised","CubeIcon","faCube","MapIcon","faTh","FireIcon","faFire","SquareIcon","faSquare","UserIcon","faUser","RobotIcon","faRobot","GhostIcon","faGhost","CharacterWrapper","$showName","$color","CharacterIcon","showName","rest","coordinates","top","left","name","isNPC","ICON_STYLE","fontSize","width","powerUpIconPack","generateIconPackFromPowerUps","DeadIcon","faBookDead","DeadCharacter","explodingDuration","onDeathAnimationComplete","default","icons","PowerUp","Life","success","faHeart","BombCount","faBomb","BombSize","warning","faPrescriptionBottleAlt","MovementSpeed","faShoePrints","Wrapper","$name","pixelMultiplier","spriteSize","spriteSheetSize","spriteSheetSquareSize","translateDiff","topDiff","labelFontSize","labelTopDiff","floor","labelMaxWidth","spriteSizing","spriteSheetSizing","useSpriteCharacterAction","shouldBindEvent","keyboardConfig","onPlayerIsWalking","setDirection","setIsWalking","lastMovementTime","Date","getTime","handleKeyDown","newDirection","getMoveDirectionFromKeyboardCode","code","getDirection","updateDirection","handleKeyUp","delayedCurrentTime","document","addEventListener","removeEventListener","SpriteCharacter","highlight","isWalking","defaultIsWalking","direction","defaultDirection","Direction","DOWN","eventDirection","setEventDirection","eventIsWalking","setEventIsWalking","className","data-facing","data-walking","toString","data-highlight","src","alt","useFirebaseUtils","baseRefPath","firebase","useFirebase","useFirebaseConnect","getPath","subPath","create","a","newProps","subPaths","uniqueSet","dataSnapshot","onSuccess","onError","read","state","isLoaded","isEmpty","update","remove","H1Wrapper","H1","NoAccess","children","fullHeight","spacing","iconStyle","reduce","acc","powerUpIcons","Icon","generatePowerUpSection","max","movementStops","powerUp","label","type","FormComponent","Rating","Slider","step","marks","generateMarks","minOrStops","maxOrNull","Array","isArray","diff","fill","_","ind","selectFirebase","LazyJoin","loadable","defaultGameState","generateDefaultGameState","refKey","removeOnlineGame","useOnlineGameActions","onlineGameFromFirebase","useSelector","createSelector","online","data","makeSelectOnlineGame","LoadingIndicator","noWrapper","gameState","gameMap","bombs","powerUps","is3D","isSideView","animationCounter","config","PlayerCondition","Alive","playerConfig","generatePlayer","gameConfig","onPlayerExit","playerLength","onPlayerDeath","Dead","customConfig","dictionaries","colors","animals","separator","getRandomName","uniqueNamesGenerator","createOnlineGame","randomName","FloatingGhostIcon","$playerId","isGameEnd","container","justify","item","xs","sm","text","fullWidth","bg","variant","disabled","onClick","sort","isCurrentPlayer","isGameEndDeadCharacter","noop","useBeforeUnload","onBeforeUnload","onUnload","listen"],"mappings":"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","file":"static/js/13.e818158d.chunk.js","sourcesContent":["import { OnlineGameId, PlayerId } from 'containers/Game/types';\nimport { useEffect, useRef, useState } from 'react';\nimport useWatchOnlineGame from 'store/firebase/hooks/useWatchOnlineGame';\nimport { useHistory } from 'react-router-dom';\nimport { BASE_PATH } from 'routes/constants';\nimport useOnPlayerExitOnline from 'hooks/useOnPlayerExitOnline';\nimport theme from 'theme';\nimport Spacer from 'components/Spacer';\nimport { H1, H4 } from 'components/typography';\n// import { mapPlayersToGamePlayers } from 'utils/game';\nimport PlayerDisplay from './PlayerDisplay';\n\ninterface Props {\n\t// playerId: PlayerId;\n\tgameId: OnlineGameId;\n}\n\nconst WaitingRoom = ({ gameId }: Props) => {\n\tconst { push } = useHistory();\n\n\tconst {\n\t\tpending,\n\t\terror,\n\t\tgame,\n\t\tisReady,\n\t\tonPlayerJoin,\n\t\tonStartGame,\n\t} = useWatchOnlineGame(gameId);\n\n\tconst npcPlayerIds = useRef<Array<PlayerId>>([]);\n\n\t// // setup the NPCs\n\t// useEffect(() => {\n\t// \tif (!isReady) return;\n\n\t// \tconst {\n\t// \t\tgameState: {\n\t// \t\t\tplayers,\n\t// \t\t\tconfig: { powerUps: powerUpConfig },\n\t// \t\t},\n\t// \t} = game;\n\t// \tconst mappedPlayers = mapPlayersToGamePlayers(players, powerUpConfig);\n\t// \tObject.keys(mappedPlayers).forEach(playerId => {\n\t// \t\tonPlayerJoin(playerId as PlayerId, true);\n\t// \t\tnpcPlayerIds.current.push(playerId as PlayerId);\n\t// \t});\n\t// \t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t// }, []);\n\n\tconst [canStart, setCanStart] = useState(false);\n\n\tconst [\n\t\tcurrentOnlinePlayerId,\n\t\tsetCurrentOnlinePlayerId,\n\t] = useState<PlayerId>();\n\n\tuseOnPlayerExitOnline(gameId, currentOnlinePlayerId);\n\n\tuseEffect(() => {\n\t\tif (!isReady) return;\n\n\t\tconst { gamePlayers } = game;\n\t\tconst playerKeys = Object.keys(gamePlayers);\n\t\tconst playerCount = playerKeys.length;\n\n\t\tif (game.started) {\n\t\t\tpush(`${BASE_PATH}/unauthorized`, {\n\t\t\t\tmessage: 'Game has already started!',\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tif (playerCount > 3) {\n\t\t\tpush(`${BASE_PATH}/unauthorized`, { message: 'Game is full!' });\n\t\t\treturn;\n\t\t}\n\t\t// Pick a number that's the smallest from non existing player ids\n\t\t// i.e. P1 joins, P2 joins, P1 leaves, P1 joins, he should be assigned\n\t\t// P1 and not P2 (because ind + 1 will be 2 at this point)\n\t\tconst currentPlayerNumbers = playerKeys.map(key => {\n\t\t\treturn Number(key.replace('P', ''));\n\t\t});\n\t\tconst openPlayerNumbers = [1, 2, 3, 4].filter(openNumber => {\n\t\t\treturn !currentPlayerNumbers.includes(openNumber);\n\t\t});\n\t\tconst newPlayerId = `P${Math.min(...openPlayerNumbers)}` as PlayerId;\n\t\tonPlayerJoin(newPlayerId);\n\t\t// TODO: error checking?\n\t\tsetCurrentOnlinePlayerId(newPlayerId);\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [isReady]);\n\n\tuseEffect(() => {\n\t\tif (!isReady) return;\n\t\tif (!game?.started) return;\n\n\t\tpush(`${BASE_PATH}/online/${gameId}`, {\n\t\t\tplayerId: currentOnlinePlayerId,\n\t\t});\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [isReady, game?.started]);\n\n\tuseEffect(() => {\n\t\tif (!isReady) return;\n\n\t\tconst { gamePlayers } = game;\n\t\tconst playerCount = Object.keys(gamePlayers).length;\n\n\t\t// we don't want to count the NPCs, there should be\n\t\t// at least 2 Human Players\n\t\tif (playerCount - npcPlayerIds.current.length > 1) {\n\t\t\tsetCanStart(true);\n\t\t}\n\t}, [game, isReady]);\n\n\tconst {\n\t\tlocation: { origin, pathname },\n\t} = window;\n\tconst link = origin + pathname;\n\n\treturn (\n\t\tpending ||\n\t\terror || (\n\t\t\t<>\n\t\t\t\t<H1> Waiting Room </H1>\n\t\t\t\t<Spacer />\n\t\t\t\t<H4>\n\t\t\t\t\tRoom / Game Id:\n\t\t\t\t\t<br />\n\t\t\t\t\t<span style={{ color: theme.palette.color.info }}>\n\t\t\t\t\t\t{gameId}\n\t\t\t\t\t</span>\n\t\t\t\t</H4>\n\t\t\t\t<Spacer />\n\t\t\t\t<H4>\n\t\t\t\t\tJoin Link:\n\t\t\t\t\t<br />\n\t\t\t\t\t<span style={{ color: theme.palette.color.info }}>\n\t\t\t\t\t\t{link}\n\t\t\t\t\t</span>\n\t\t\t\t</H4>\n\t\t\t\t<PlayerDisplay\n\t\t\t\t\tplayers={game.gamePlayers}\n\t\t\t\t\tonStartGame={onStartGame}\n\t\t\t\t\tcanStart={canStart}\n\t\t\t\t\tcurrentOnlinePlayerId={currentOnlinePlayerId}\n\t\t\t\t/>\n\t\t\t</>\n\t\t)\n\t);\n};\n\nexport default WaitingRoom;\n","import PageContainer from 'components/PageContainer';\nimport { RouteComponentPropsWithLocationState } from 'routes/types';\nimport WaitingRoom from 'containers/WaitingRoom';\n\ninterface Props extends RouteComponentPropsWithLocationState<{ id: string }> {}\n\n// TODO\nconst WaitingRoomPage = ({\n\tmatch: {\n\t\tparams: { id },\n\t},\n}: Props) => {\n\treturn (\n\t\t<PageContainer style={{ overflow: 'hidden' }}>\n\t\t\t<WaitingRoom gameId={id} />\n\t\t</PageContainer>\n\t);\n};\n\nexport default WaitingRoomPage;\n","import { keyframes } from 'styled-components';\n\n/** @see https://codepen.io/nelledejones/pen/gOOPWrK#L68 */\nconst bounceAnimation = (withOpacity = false) => keyframes`\n\t0% { transform: scale(0, 0); }\n\t25% { transform: scale(0.9, 1.1); }\n\t50% { transform: scale(1.1, 0.9); }\n\t75% { transform: scale(0.95, 1.05); }\n\t100% { transform: scale(1, 1); ${(withOpacity && 'opacity: 1;') || ''} }\n`;\n\nconst ghostAnimation = (size: number, color: string) => keyframes`\n\t0%, 100% { \n\t\ttransform: translateY(0px); \n\t\tbox-shadow: 0 10px 10px #000000;\n\t}\n\t50% {\n\t\ttransform: translateY(-10px);\n\t\tbox-shadow: 0 20px ${Math.ceil(size / 6) + 10}px ${color};\n\t}\n`;\n\nexport { bounceAnimation, ghostAnimation };\n","const sleep = (duration = 1000) => {\n\treturn new Promise(r => {\n\t\tsetTimeout(r, duration);\n\t});\n};\n\n/**\n * Wraps the button on click with a blur event to undo auto on focus. This is\n * especially annoying when view is changed and the user hits the \"Space\"\n * button and it switches the view back as it's \"focus\"ed on.\n *\n * @param cb Curried function where callback is wrapped with this utility.\n * @returns Base event cb\n */\nconst wrapPreventFocusLock = (\n\tcb: (e: React.MouseEvent<HTMLButtonElement, MouseEvent>) => void\n) => (e: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\n\t// undo onFocus lock\n\te.currentTarget.blur();\n\tcb(e);\n};\n\nconst doesNotExist = (value: any) => value === null || value === undefined;\n\nconst findEnumKeyFromValue = (enumerable: object, key: string) => {\n\treturn Object.keys(enumerable)[Object.values(enumerable).indexOf(key)];\n};\n\nexport { sleep, wrapPreventFocusLock, doesNotExist, findEnumKeyFromValue };\n","import { bounceAnimation } from 'animations';\nimport styled, { css } from 'styled-components';\n\nconst TileIcon = styled.div<{\n\t$size: number;\n\t$top: number;\n\t$left: number;\n\t$animationDelay?: string;\n}>`\n\tposition: absolute;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\topacity: 0;\n\tsvg {\n\t\theight: 100% !important;\n\t\twidth: 100% !important;\n\t\tmax-width: 70%;\n\t\tmax-height: 80%;\n\t}\n\t${({ $size, $animationDelay, $top, $left }) => css`\n\t\ttop: ${$top}px;\n\t\tleft: ${$left}px;\n\t\twidth: ${$size}px;\n\t\theight: ${$size}px;\n\t\tanimation: ${bounceAnimation(true)} var(--block-animation-duration)\n\t\t\t${$animationDelay || ''} ease-out forwards;\n\t`}\n`;\n\nexport default TileIcon;\n","import {\n\tfaFistRaised,\n\tfaCube,\n\tfaTh,\n\tfaSquare,\n\tfaFire,\n\tfaUser,\n\tfaRobot,\n\tfaGhost,\n} from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport DeadCharacter from 'containers/Game/components/DeadCharacter';\nimport SpriteCharacter, {\n\tSpriteCharacterProps,\n} from 'containers/Game/components/SpriteCharacter';\nimport { FontAwesomeIconProps } from 'containers/Game/types';\nimport styled from 'styled-components';\nimport { generateIconPackFromPowerUps } from './utils';\n\nconst PowerUpIcon = (props: FontAwesomeIconProps) => (\n\t<FontAwesomeIcon icon={faFistRaised} {...props} />\n);\n\nconst CubeIcon = (props: FontAwesomeIconProps) => (\n\t<FontAwesomeIcon icon={faCube} {...props} />\n);\n\nconst MapIcon = (props: FontAwesomeIconProps) => (\n\t<FontAwesomeIcon icon={faTh} {...props} />\n);\n\nconst FireIcon = (props: FontAwesomeIconProps) => (\n\t<FontAwesomeIcon icon={faFire} {...props} />\n);\n\nconst SquareIcon = (props: FontAwesomeIconProps) => (\n\t<FontAwesomeIcon icon={faSquare} {...props} />\n);\n\nconst UserIcon = (props: FontAwesomeIconProps) => (\n\t<FontAwesomeIcon icon={faUser} {...props} />\n);\n\nconst RobotIcon = (props: FontAwesomeIconProps) => (\n\t<FontAwesomeIcon icon={faRobot} {...props} />\n);\n\nconst GhostIcon = (props: FontAwesomeIconProps) => (\n\t<FontAwesomeIcon icon={faGhost} {...props} />\n);\n\nconst CharacterWrapper = styled.div<\n\tStyledProps<CharacterIconProps, 'size' | 'showName' | 'color'>\n>`\n\tposition: relative;\n\tpointer-events: none;\n\tmin-width: 50px;\n\n\t${({ $showName, $color }) => {\n\t\treturn `\n\t\t\t.name {\n\t\t\t\t${!$showName ? 'display: none;' : ''}\n\t\t\t\t${$color ? `background-color: ${$color} !important;` : ''}\n\t\t\t\t\n\t\t\t}\n\t\t`;\n\t}}\n\n\t${({ $size }) => {\n\t\treturn `\n\t\t\twidth: ${$size}px;\n\t\t\theight: ${$size}px;\n\n\t\t\t> div {\n\t\t\t\t/* Gotta override as char is taking coordinates by default */\n\t\t\t\ttop: ${$size / 2}px !important;\n\t\t\t\tleft: calc(50% - ${$size}px / 2) !important;\n\t\t\t}\n\t\t`;\n\t}}\n`;\n\ninterface CharacterIconProps extends Partial<SpriteCharacterProps> {\n\tsize: SpriteCharacterProps['size'];\n\tcolor?: string;\n\tshowName?: boolean;\n}\n\nconst CharacterIcon = ({\n\tsize,\n\tshowName = false,\n\tcolor,\n\t...rest\n}: CharacterIconProps) => {\n\treturn (\n\t\t<CharacterWrapper $size={size} $showName={showName} $color={color}>\n\t\t\t<SpriteCharacter\n\t\t\t\tcoordinates={{ top: 0, left: 0 }}\n\t\t\t\tid=\"P1\"\n\t\t\t\tname=\"Bomba-man\"\n\t\t\t\tisNPC\n\t\t\t\tsize={size}\n\t\t\t\t{...rest}\n\t\t\t/>\n\t\t</CharacterWrapper>\n\t);\n};\n\nconst DeadCharacterIcon = ({\n\tsize,\n\tshowName = false,\n\t...rest\n}: CharacterIconProps) => {\n\treturn (\n\t\t<CharacterWrapper $size={size} $showName={showName}>\n\t\t\t<DeadCharacter\n\t\t\t\tcoordinates={{ top: 0, left: 0 }}\n\t\t\t\tid=\"P1\"\n\t\t\t\tname=\"Bomba-man\"\n\t\t\t\texplodingDuration={0 as any}\n\t\t\t\tsize={size}\n\t\t\t\t{...rest}\n\t\t\t/>\n\t\t</CharacterWrapper>\n\t);\n};\n\nconst ICON_STYLE = { fontSize: 40, width: 50 };\nconst powerUpIconPack = generateIconPackFromPowerUps(ICON_STYLE);\n\nexport type { CharacterIconProps };\nexport {\n\tPowerUpIcon,\n\tCubeIcon,\n\tMapIcon,\n\tFireIcon,\n\tSquareIcon,\n\tUserIcon,\n\tRobotIcon,\n\tGhostIcon,\n\tCharacterIcon,\n\tDeadCharacterIcon,\n\tpowerUpIconPack,\n\tICON_STYLE,\n};\n","import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faBookDead } from '@fortawesome/free-solid-svg-icons';\nimport {\n\tFontAwesomeIconProps,\n\tPlayerId,\n\tTopLeftCoordinates,\n} from 'containers/Game/types';\nimport theme from 'theme';\nimport { GameConfigRanges } from 'store/redux/reducers/game/types';\nimport { useEffect } from 'react';\nimport TileIcon from './TileIcon';\nimport { SpriteCharacterProps } from './SpriteCharacter';\n\nconst DeadIcon = (props: FontAwesomeIconProps) => (\n\t<FontAwesomeIcon icon={faBookDead} {...props} />\n);\n\ninterface Props extends Omit<SpriteCharacterProps, 'onPlayerIsWalking'> {\n\texplodingDuration: GameConfigRanges.ExplodingDuration;\n\tcoordinates: TopLeftCoordinates;\n\tonDeathAnimationComplete?: (playerId: PlayerId) => void;\n}\n\nconst DeadCharacter = ({\n\tid,\n\t// name,\n\tsize,\n\texplodingDuration,\n\tcoordinates: { top, left },\n\tonDeathAnimationComplete,\n}: Props) => {\n\tuseEffect(() => {\n\t\tsetTimeout(() => {\n\t\t\tonDeathAnimationComplete?.(id);\n\t\t}, explodingDuration * 1000 + 1000);\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, []);\n\treturn (\n\t\t<TileIcon\n\t\t\t$top={top}\n\t\t\t$left={left}\n\t\t\t$size={size}\n\t\t\t$animationDelay={`${explodingDuration}s`}\n\t\t>\n\t\t\t<DeadIcon color={theme.palette.color.default} />\n\t\t\t{/* <div className=\"name\">{name}</div> */}\n\t\t</TileIcon>\n\t);\n};\n\nexport default DeadCharacter;\n","import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n\tfaShoePrints,\n\tfaHeart,\n\tfaBomb,\n\tfaPrescriptionBottleAlt,\n} from '@fortawesome/free-solid-svg-icons';\nimport { PowerUp } from 'enums';\nimport theme from 'theme';\nimport { FontAwesomeIconProps } from 'containers/Game/types';\n\nconst ShoePrintsIcon = (props: FontAwesomeIconProps) => (\n\t<FontAwesomeIcon icon={faShoePrints} {...props} />\n);\nconst HeartIcon = (props: FontAwesomeIconProps) => (\n\t<FontAwesomeIcon icon={faHeart} {...props} />\n);\nconst BombIcon = (props: FontAwesomeIconProps) => (\n\t<FontAwesomeIcon icon={faBomb} {...props} />\n);\nconst PrescriptionBottleAltIcon = (props: FontAwesomeIconProps) => (\n\t<FontAwesomeIcon icon={faPrescriptionBottleAlt} {...props} />\n);\n\nconst icons: Record<\n\tPowerUp,\n\t{ icon: (props: FontAwesomeIconProps) => JSX.Element; color: string }\n> = {\n\t[PowerUp.Life]: {\n\t\tcolor: theme.palette.color.success,\n\t\ticon: HeartIcon,\n\t},\n\t[PowerUp.BombCount]: {\n\t\tcolor: theme.palette.color.error,\n\t\ticon: BombIcon,\n\t},\n\t[PowerUp.BombSize]: {\n\t\tcolor: theme.palette.color.warning,\n\t\ticon: PrescriptionBottleAltIcon,\n\t},\n\t[PowerUp.MovementSpeed]: {\n\t\tcolor: theme.palette.color.info,\n\t\ticon: ShoePrintsIcon,\n\t},\n};\n\nexport default icons;\n","import { Direction } from 'enums';\nimport { useEffect, useRef, useState } from 'react';\nimport { getMoveDirectionFromKeyboardCode } from 'utils/game';\nimport styled, { css } from 'styled-components';\nimport theme from 'theme';\nimport { CharacterProps } from './Character';\nimport './SpriteCharacter.scss';\nimport spriteShadow from './character-shadow.png';\nimport spriteImage from './character-skin-default.png';\n\nconst SPRITE_SQUARE_SIZE = 32;\nconst Wrapper = styled.div<{ $size: number; $name: string }>`\n\t${({ $size, $name }) => {\n\t\t// CALCULATED\n\t\tconst pixelMultiplier = $size / SPRITE_SQUARE_SIZE;\n\t\tconst spriteSize = pixelMultiplier * SPRITE_SQUARE_SIZE;\n\t\tconst spriteSheetSize = spriteSize * 4;\n\t\tconst spriteSheetSquareSize = pixelMultiplier * -1 * SPRITE_SQUARE_SIZE;\n\t\tconst translateDiff = ($size / 4) * -1;\n\t\tconst topDiff = Math.min(-15, translateDiff * 2.5);\n\t\tconst labelFontSize = Math.min(30, Math.ceil(spriteSize / 6));\n\t\tconst labelTopDiff = Math.floor(spriteSize / (5 * 2));\n\t\t// const labelMaxWidth = Math.ceil(spriteSize * 0.8);\n\t\tconst labelMaxWidth = Math.floor(\n\t\t\t$name.length * 20 + (spriteSize * pixelMultiplier) / 10\n\t\t);\n\n\t\tconst spriteSizing = `\n\t\t\twidth: ${spriteSize}px;\n\t\t\theight: ${spriteSize}px;\n\t\t`;\n\t\tconst spriteSheetSizing = `\n\t\t\twidth: ${spriteSheetSize}px;\n\t\t\theight: ${spriteSheetSize}px;\n\t\t`;\n\n\t\treturn css`\n\t\t\tposition: absolute;\n\t\t\tz-index: 9999;\n\t\t\t${spriteSizing};\n\t\t\ttransition-duration: 450ms;\n\n\t\t\t&#P1 .name {\n\t\t\t\tbackground-color: ${theme.palette.color.warning};\n\t\t\t}\n\t\t\t&#P2 .name {\n\t\t\t\tbackground-color: ${theme.palette.color.info};\n\t\t\t}\n\t\t\t&#P3 .name {\n\t\t\t\tbackground-color: ${theme.palette.color.success};\n\t\t\t}\n\t\t\t&#P4 .name {\n\t\t\t\tbackground-color: ${theme.palette.color.error};\n\t\t\t}\n\n\t\t\t.character {\n\t\t\t\ttop: ${topDiff}px;\n\t\t\t\ttransform: translate(${translateDiff}px);\n\n\t\t\t\t${spriteSizing};\n\t\t\t\toverflow: hidden;\n\t\t\t\tposition: relative;\n\t\t\t\t/* MOVEMENT TRANSITION */\n\t\t\t\ttransition-duration: 400ms;\n\n\t\t\t\t& .name {\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\tleft: 0;\n\t\t\t\t\tright: 0;\n\t\t\t\t\ttop: ${labelTopDiff}px;\n\t\t\t\t\tfont-size: ${labelFontSize}px;\n\t\t\t\t\tmax-width: ${labelMaxWidth}px;\n\t\t\t\t\tfont-weight: bold;\n\t\t\t\t\tborder: 1px dashed white;\n\t\t\t\t\tborder-radius: 9999px;\n\t\t\t\t\topacity: 1;\n\t\t\t\t\tmargin: auto;\n\t\t\t\t\ttext-align: center;\n\t\t\t\t}\n\n\t\t\t\t& .shadow {\n\t\t\t\t\t${spriteSizing};\n\t\t\t\t\topacity: 0.75;\n\t\t\t\t}\n\n\t\t\t\t& .spritesheet {\n\t\t\t\t\t${spriteSheetSizing};\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\ttop: 0;\n\t\t\t\t\tleft: 0;\n\t\t\t\t}\n\n\t\t\t\t/* DIRECTION */\n\t\t\t\t&[data-facing='Right'] .spritesheet {\n\t\t\t\t\ttop: ${spriteSheetSquareSize * 1}px;\n\t\t\t\t}\n\t\t\t\t&[data-facing='Up'] .spritesheet {\n\t\t\t\t\ttop: ${spriteSheetSquareSize * 2}px;\n\t\t\t\t}\n\t\t\t\t&[data-facing='Left'] .spritesheet {\n\t\t\t\t\ttop: ${spriteSheetSquareSize * 3}px;\n\t\t\t\t}\n\n\t\t\t\t&[data-walking='true'] {\n\t\t\t\t\t/* MOVEMENT ANIMATION */\n\t\t\t\t\t.spritesheet {\n\t\t\t\t\t\tanimation: walkAnimation 0.6s steps(4) infinite;\n\t\t\t\t\t}\n\n\t\t\t\t\t/* SHADOW ANIMATION */\n\t\t\t\t\t.shadow {\n\t\t\t\t\t\tanimation: shadowAnimation 0.3s infinite;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/* HIGHLIGHT/DAMAGE ANIMATION */\n\t\t\t\t&[data-highlight='true'] .spritesheet {\n\t\t\t\t\tanimation: opacityAnimation 0.6s steps(4) infinite;\n\t\t\t\t}\n\t\t\t}\n\t\t`;\n\t}}\n`;\n\nconst ANIMATION_STOP_THROTTLE_DURATION = 200;\n\ninterface Props extends Omit<CharacterProps, 'tileSize' | 'is3D' | 'size'> {\n\t// size can be any number by default, unless it's a game character\n\tsize: number;\n}\n\ntype UseSpriteCharacterAction = Omit<Props, 'coordinates' | 'name' | 'size'> & {\n\tshouldBindEvent: boolean;\n\t// setters\n\tsetDirection: React.Dispatch<React.SetStateAction<Direction>>;\n\tsetIsWalking: React.Dispatch<React.SetStateAction<boolean>>;\n};\n\nconst useSpriteCharacterAction = ({\n\tid,\n\tshouldBindEvent,\n\tkeyboardConfig,\n\t// state setter\n\tonPlayerIsWalking,\n\t// setters\n\tsetDirection,\n\tsetIsWalking,\n}: UseSpriteCharacterAction) => {\n\tconst lastMovementTime = useRef(new Date().getTime());\n\n\tuseEffect(() => {\n\t\t// ignore the npc action\n\t\tconst getDirection = (e: KeyboardEvent) => {\n\t\t\treturn keyboardConfig\n\t\t\t\t? getMoveDirectionFromKeyboardCode(e.code, keyboardConfig)\n\t\t\t\t: null;\n\t\t};\n\n\t\tconst updateDirection = (newDirection: Direction) => {\n\t\t\tsetDirection(newDirection);\n\t\t};\n\n\t\tconst handleKeyDown = (e: KeyboardEvent) => {\n\t\t\tif (!shouldBindEvent) return;\n\n\t\t\tconst newDirection = getDirection(e);\n\t\t\tif (!newDirection) {\n\t\t\t\tonPlayerIsWalking?.(false, id);\n\t\t\t\tsetIsWalking(false);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlastMovementTime.current = new Date().getTime();\n\t\t\tsetIsWalking(true);\n\t\t\tupdateDirection(newDirection);\n\t\t};\n\n\t\tconst handleKeyUp = () => {\n\t\t\tif (!shouldBindEvent) return;\n\t\t\t// keypress-move: keydown + keyup, i.e. D, D, D (not hold D)\n\t\t\t// Only stop the moving animation after the player goes idle\n\t\t\t// for some duration. This allows us to use keypress to move\n\t\t\t// and still have a move animation (instead of keydown).\n\t\t\t// This is needed because otherwise keypress-move wont trigger\n\t\t\t// animations.\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst delayedCurrentTime =\n\t\t\t\t\tnew Date().getTime() - ANIMATION_STOP_THROTTLE_DURATION;\n\t\t\t\tif (lastMovementTime.current >= delayedCurrentTime) return;\n\t\t\t\tsetIsWalking(false);\n\t\t\t\tonPlayerIsWalking?.(false, id);\n\t\t\t}, ANIMATION_STOP_THROTTLE_DURATION);\n\t\t};\n\n\t\t//\n\t\tif (shouldBindEvent) {\n\t\t\tdocument.addEventListener('keydown', handleKeyDown);\n\t\t\tdocument.addEventListener('keyup', handleKeyUp);\n\t\t}\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('keydown', handleKeyDown);\n\t\t\tdocument.removeEventListener('keyup', handleKeyUp);\n\t\t};\n\t}, [\n\t\tid,\n\t\tkeyboardConfig,\n\t\tonPlayerIsWalking,\n\t\tsetDirection,\n\t\tsetIsWalking,\n\t\tshouldBindEvent,\n\t]);\n};\n\nconst SpriteCharacter = ({\n\tid,\n\tcurrentOnlinePlayerId,\n\tname,\n\tcoordinates: { top, left },\n\tstyle,\n\tkeyboardConfig,\n\thighlight,\n\tsize,\n\tonPlayerIsWalking,\n\tisWalking: defaultIsWalking = false,\n\tdirection: defaultDirection = Direction.DOWN,\n\tisNPC = false,\n\t...rest\n}: Props) => {\n\t/** Direction being faced */\n\tconst [eventDirection, setEventDirection] = useState<Direction>(\n\t\tdefaultDirection\n\t);\n\tconst [eventIsWalking, setEventIsWalking] = useState<boolean>(\n\t\tdefaultIsWalking\n\t);\n\n\t// We only want to bind the event if it's:\n\t// - not online game\n\t// - online game and it's the current player\n\tconst shouldBindEvent =\n\t\t!isNPC && (!currentOnlinePlayerId || id === currentOnlinePlayerId);\n\n\tuseSpriteCharacterAction({\n\t\tid,\n\t\tcurrentOnlinePlayerId,\n\t\tkeyboardConfig,\n\t\tshouldBindEvent,\n\t\t// state setter\n\t\tonPlayerIsWalking,\n\t\t// setters\n\t\tsetDirection: setEventDirection,\n\t\tsetIsWalking: setEventIsWalking,\n\t});\n\n\tlet isWalking = defaultIsWalking;\n\tlet direction = defaultDirection;\n\n\tif (shouldBindEvent) {\n\t\tisWalking = eventIsWalking;\n\t\tdirection = eventDirection;\n\t}\n\n\treturn (\n\t\t<Wrapper\n\t\t\tid={id}\n\t\t\tstyle={{\n\t\t\t\t...style,\n\t\t\t\ttop,\n\t\t\t\tleft,\n\t\t\t}}\n\t\t\tclassName=\"character-wrapper\"\n\t\t\t{...rest}\n\t\t\t$size={size * 2}\n\t\t\t$name={name}\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName=\"character\"\n\t\t\t\tdata-facing={direction}\n\t\t\t\tdata-walking={isWalking.toString()}\n\t\t\t\tdata-highlight={highlight}\n\t\t\t>\n\t\t\t\t<div className=\"name\">{name}</div>\n\t\t\t\t<img\n\t\t\t\t\tclassName=\"shadow pixel-art\"\n\t\t\t\t\tsrc={spriteShadow}\n\t\t\t\t\talt=\"sprite skin\"\n\t\t\t\t/>\n\t\t\t\t<img\n\t\t\t\t\tclassName=\"spritesheet pixel-art\"\n\t\t\t\t\tsrc={spriteImage}\n\t\t\t\t\talt=\"sprite skin\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</Wrapper>\n\t);\n};\n\nexport type { Props as SpriteCharacterProps };\nexport default SpriteCharacter;\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAWUlEQVRYR+3XsQkAIAxEUe2cRXADx3cDwVksJYX970T41sE7Xqrk9Pjlx/nJAgoooIACCiiggAIKKKDAXwKt9k0uqblGIXMxgwVo+A2mJSyABYKWroHyx58Hv0cUIWfm8TkAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,UklGRuYBAABXRUJQVlA4TNkBAAAvf8AfEDegkI0kaB1Wc63vv4M4DQUByDA6SKk4ex2mqG0bqCCKrfwp7N5em/8A4P9XnTtjLpKQBLi1tbdt/gbqnTCAN/D5RCygH6yhQ4C1GfefQQG/fjA4FhH9Z9i2bZjkAbZdhsAn0N9Qh3Rps6Tr7enSZ9lZ1PV+6bPsLO4q4Fj1ORugiqJzAdemHQCwqMszM8vOoq4wzXNrso4rVOW6YeXnwAFDfg66i/MBl3QOm5+DDrAmX0BjNK5QAfYsOYVzJHCjcr1VjGTyTmZhrj2PUeUKvuZIeWc7iQ6TdK4URIcJSXIQyS75V0Q70f+F9g48tFcs4Nq6A4Vd69w7RGdRF4UBhmRnWZd1wlhZB3tQuabj0JFQXb4+n2pMKlfoeHgRzhW9cK7ZcyKVa2Kehcn3SWRURueqkpdcSWIEE0jv+ne4d0DeKxZw7a5jV/aO4IDByDlGSZe/VvYc1dUpu+RzNrlqa+ZxyrtOPESNyzs+5s9FtbRGUT2mUeUKdapHZe4wkzZ3oH+muYNvAMjO8q5tO7CMS7MHeJRxrSt3gHsgVzBlXYOUG3QYOtK4yLpTq8oVqMX4dFDlEh+OrVHlConjTLpcgrklARpJcDYpKl0xNco1wgRTwLUPTQA=\"","import LoadingIndicator from 'components/LoadingIndicator';\nimport NoAccess from 'components/NoAccess';\nimport {\n\tisEmpty,\n\tisLoaded,\n\tuseFirebase,\n\tuseFirebaseConnect,\n} from 'react-redux-firebase';\nimport { DataSnapshot, FirebaseUtils } from '../types';\n// eslint-disable-next-line import/no-unresolved\n// import { fromFirestore } from '../utils';\n// TODO: notification-provider\n// import useNotificationProvider from 'store/redux/hooks/useNotificationProvider';\n\nconst useFirebaseUtils = <RootSchema extends FirebaseUtils.UpdateableValue>(\n\tbaseRefPath: string\n) => {\n\t// const { notifyError } = useNotificationProvider();\n\tconst firebase = useFirebase();\n\tuseFirebaseConnect([baseRefPath]);\n\n\tconst getPath = (subPath?: FirebaseUtils.RefSubPath) => {\n\t\treturn `${baseRefPath}${subPath || ''}`;\n\t};\n\n\t/**\n\t * @example\n\t * ```ts\n\t * // Usage 1: Generate random id\n\t * const { key: newGameId } = (await create(newProps, subPaths)) as DataSnapshot;\n\t *\n\t * // Usage 2: Set your own id (fails if exists)\n\t * const customId = 'some-id';\n\t * await create(newProps, subPaths, undefined, customId);\n\t * ```\n\t */\n\tconst create = async <\n\t\tOverrideSchema extends FirebaseUtils.OverridableValue = void\n\t>(\n\t\t...[newProps, subPaths, cb, key]: FirebaseUtils.CreateProps<\n\t\t\tRootSchema,\n\t\t\tOverrideSchema\n\t\t>\n\t): FirebaseUtils.DataSnapshotPromise => {\n\t\ttry {\n\t\t\tlet dataSnapshot: DataSnapshot;\n\t\t\t// if provided with a key, first check if document exists\n\t\t\t// if it\n\t\t\tif (key) {\n\t\t\t\tdataSnapshot = await firebase.uniqueSet(getPath(subPaths), {\n\t\t\t\t\t[key]: newProps,\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tdataSnapshot = await firebase.push(getPath(subPaths), newProps);\n\t\t\t}\n\t\t\tcb?.onSuccess?.(dataSnapshot);\n\n\t\t\treturn dataSnapshot;\n\t\t} catch (err) {\n\t\t\tif (cb?.onError) cb.onError(err);\n\t\t\t// else notifyError(err);\n\t\t\treturn err;\n\t\t}\n\t};\n\n\tconst read = <OverrideSchema extends FirebaseUtils.OverridableValue = void>(\n\t\t...[state]: FirebaseUtils.ReadProps<RootSchema, OverrideSchema>\n\t) => {\n\t\tconst pending = !isLoaded(state) && <LoadingIndicator />;\n\t\tconst error = isEmpty(state) && <NoAccess />;\n\t\treturn {\n\t\t\tstate,\n\t\t\tpending,\n\t\t\terror,\n\t\t};\n\t};\n\n\tconst update = async <\n\t\tOverrideSchema extends FirebaseUtils.OverridableValue = void\n\t>(\n\t\t...[newProps, subPaths, cb]: FirebaseUtils.UpdateProps<\n\t\t\tRootSchema,\n\t\t\tOverrideSchema\n\t\t>\n\t): FirebaseUtils.DataSnapshotPromise => {\n\t\ttry {\n\t\t\tconst dataSnapshot = await firebase.update(\n\t\t\t\tgetPath(subPaths),\n\t\t\t\tnewProps\n\t\t\t);\n\t\t\tcb?.onSuccess?.(dataSnapshot);\n\t\t\treturn dataSnapshot;\n\t\t} catch (err) {\n\t\t\tif (cb?.onError) cb.onError(err);\n\t\t\t// else notifyError(err);\n\t\t\treturn err;\n\t\t}\n\t};\n\n\tconst push = async <\n\t\tOverrideSchema extends FirebaseUtils.OverridableValue = void\n\t>(\n\t\t...[newProps, subPaths, cb]: FirebaseUtils.PushProps<\n\t\t\tRootSchema,\n\t\t\tOverrideSchema\n\t\t>\n\t): FirebaseUtils.DataSnapshotPromise => {\n\t\ttry {\n\t\t\tconst dataSnapshot = await firebase.push(\n\t\t\t\tgetPath(subPaths),\n\t\t\t\tnewProps\n\t\t\t);\n\t\t\tcb?.onSuccess?.(dataSnapshot);\n\t\t\treturn dataSnapshot;\n\t\t} catch (err) {\n\t\t\tif (cb?.onError) cb.onError(err);\n\t\t\t// else notifyError(err);\n\t\t\treturn err;\n\t\t}\n\t};\n\n\tconst remove = async (\n\t\t...[subPaths, cb]: FirebaseUtils.RemoveProps\n\t): FirebaseUtils.DataSnapshotPromise => {\n\t\ttry {\n\t\t\tconst dataSnapshot = await firebase.remove(getPath(subPaths));\n\t\t\tcb?.onSuccess?.(dataSnapshot);\n\t\t\treturn dataSnapshot;\n\t\t} catch (err) {\n\t\t\tif (cb?.onError) cb.onError(err);\n\t\t\t// else notifyError(err);\n\t\t\treturn err;\n\t\t}\n\t};\n\n\treturn {\n\t\tcreate,\n\t\tread,\n\t\tupdate,\n\t\tpush,\n\t\tremove,\n\t};\n};\n\nexport default useFirebaseUtils;\n","import PageContainer from 'components/PageContainer';\nimport { H1 } from 'components/typography';\nimport theme from 'theme';\nimport styled from 'styled-components';\nimport Spacer from 'components/Spacer';\n\nconst H1Wrapper = styled(H1)`\n\tcolor: ${theme.palette.color.error};\n`;\n\ninterface Props {\n\tmessage?: string;\n}\n\nconst DEFAULT_ERROR_MESSAGE =\n\t\"Either the game is not found or you don't have access to it.\";\nconst NoAccess: React.FC<Props> = ({\n\tchildren,\n\tmessage = DEFAULT_ERROR_MESSAGE,\n}) => (\n\t<PageContainer fullHeight>\n\t\t<Spacer spacing=\"5\" />\n\t\t<H1Wrapper>{message}</H1Wrapper>\n\t\t<Spacer spacing=\"10\" />\n\t\t{children}\n\t</PageContainer>\n);\n\nexport default NoAccess;\n","import { PowerUp } from 'enums';\nimport powerUpIcons from 'containers/Game/components/PowerUp/icons';\nimport { findEnumKeyFromValue } from 'utils';\nimport { FormComponent } from 'components/Form/types';\nimport { generateMarks } from 'utils/material-ui';\nimport { PartialConfigFormItems, PowerUpIcons } from './types';\nimport { powerUpIconPack } from './icons';\n\nconst generateIconPackFromPowerUps = (iconStyle: React.CSSProperties) => {\n\treturn Object.values(PowerUp).reduce<PowerUpIcons>((acc, key) => {\n\t\tconst { icon: Icon, color } = powerUpIcons[key];\n\n\t\tacc[key] = {\n\t\t\ticon: <Icon style={iconStyle} />,\n\t\t\tcolor,\n\t\t};\n\n\t\treturn acc;\n\t}, {} as PowerUpIcons);\n};\nconst generatePowerUpSection = (\n\tname: string,\n\tmax: number,\n\tmovementStops?: Array<number>\n) => {\n\treturn Object.values(PowerUp).map(powerUp => {\n\t\tconst label = `${findEnumKeyFromValue(PowerUp, powerUp)}`;\n\t\treturn {\n\t\t\ttype: FormComponent.Rating,\n\t\t\tlabel: `${label} (number)`,\n\t\t\tname: `${name}.${powerUp}`,\n\t\t\tmax,\n\t\t\t...powerUpIconPack[powerUp],\n\t\t\t...(movementStops &&\n\t\t\t\tpowerUp === PowerUp.MovementSpeed && {\n\t\t\t\t\tlabel: `${label} (action interval, milliseconds)`,\n\t\t\t\t\ttype: FormComponent.Slider,\n\t\t\t\t\tstep: null,\n\t\t\t\t\tmin: Math.min(...movementStops),\n\t\t\t\t\tmax: Math.max(...movementStops),\n\t\t\t\t\tmarks: generateMarks(movementStops),\n\t\t\t\t}),\n\t\t};\n\t}) as PartialConfigFormItems;\n};\n\nexport { generateIconPackFromPowerUps, generatePowerUpSection };\n","import { SliderProps } from '@material-ui/core';\n\nfunction generateMarks(stops: Array<number>): SliderProps['marks'];\nfunction generateMarks(min: number, max: number): SliderProps['marks'];\nfunction generateMarks(\n\tminOrStops: number | Array<number>,\n\tmaxOrNull?: number | undefined\n): SliderProps['marks'] {\n\t// if it's an array\n\tif (Array.isArray(minOrStops)) {\n\t\treturn minOrStops.map(value => ({\n\t\t\tvalue,\n\t\t\tlabel: value,\n\t\t}));\n\t}\n\tconst diff = (maxOrNull as number) - minOrStops;\n\treturn Array(diff + 1)\n\t\t.fill(0)\n\t\t.map((_, ind) => {\n\t\t\tconst value = minOrStops + ind;\n\t\t\treturn {\n\t\t\t\tvalue,\n\t\t\t\t...((ind === 0 || ind === diff) && { label: value }),\n\t\t\t};\n\t\t});\n}\n\nexport { generateMarks };\n","import { createSelector, Selector } from 'reselect';\nimport { Store } from 'store/redux/types';\nimport { FirebaseState } from './types';\n\n// Direct selector to the userPreferences state\nconst selectFirebase: Selector<Store, FirebaseState> = state => {\n\treturn state.firebase;\n};\n\n// Other specific selectors\nconst makeSelectAuth = () => {\n\treturn createSelector(selectFirebase, ({ auth }) => auth);\n};\n\nconst makeSelectProfile = () => {\n\treturn createSelector(selectFirebase, ({ profile }) => profile);\n};\n\nconst makeSelectOnlineGame = (id: string) => {\n\treturn createSelector(\n\t\tselectFirebase,\n\t\t({ data: { online } }) => online?.[id]\n\t);\n};\n\n// Default selector\nconst makeSelectFirebase = () => {\n\treturn createSelector(selectFirebase, state => state);\n};\n\nexport {\n\tselectFirebase,\n\tmakeSelectAuth,\n\tmakeSelectProfile,\n\tmakeSelectOnlineGame,\n};\nexport default makeSelectFirebase;\n","import { isEmpty, isLoaded, useFirebaseConnect } from 'react-redux-firebase';\nimport { useSelector } from 'react-redux';\nimport { makeSelectOnlineGame } from 'store/redux/reducers/firebase/selectors';\nimport { generateDefaultGameState, generatePlayer } from 'utils/game';\nimport LoadingIndicator from 'components/LoadingIndicator';\nimport NoAccess from 'components/NoAccess';\nimport loadable from 'utils/loadable';\nimport { OnlineGame, PlayerConfig, PlayerId } from 'containers/Game/types';\nimport gameConfig from 'config';\nimport { PlayerCondition } from 'enums';\nimport useFirebaseUtils from './useFirebaseUtils';\nimport useOnlineGameActions from './useOnlineGameActions';\n// TODO: notification-provider\n// import useNotificationProvider from 'store/redux/hooks/useNotificationProvider';\n\nconst LazyJoin = loadable(() => import(`routes/pages/Join`));\n\nconst defaultGameState = generateDefaultGameState();\n\nconst useWatchOnlineGame = (id: string) => {\n\t// const { notifyError } = useNotificationProvider();\n\tconst refKey = `online/${id}`;\n\tuseFirebaseConnect(refKey);\n\tconst { update, remove } = useFirebaseUtils<OnlineGame>(refKey);\n\tconst { removeOnlineGame } = useOnlineGameActions();\n\n\tconst onlineGameFromFirebase = useSelector(makeSelectOnlineGame(id));\n\n\tconst pending = !isLoaded(onlineGameFromFirebase) && <LoadingIndicator />;\n\tconst error = isEmpty(onlineGameFromFirebase) && (\n\t\t<NoAccess>\n\t\t\t<LazyJoin noWrapper />\n\t\t</NoAccess>\n\t);\n\n\tconst game = onlineGameFromFirebase;\n\n\tconst onPlayerJoin = (playerId: PlayerId, isNPC = false) => {\n\t\t// set player as active\n\t\tupdate<OnlineGame['gamePlayers']>(\n\t\t\t{\n\t\t\t\t[playerId]: PlayerCondition.Alive,\n\t\t\t},\n\t\t\t'/gamePlayers'\n\t\t);\n\n\t\tconst playerConfig = generatePlayer(\n\t\t\tplayerId,\n\t\t\tgame.gameState.config,\n\t\t\t(!isNPC && gameConfig.keyboardConfig) || null\n\t\t);\n\n\t\t// put him in the game state\n\t\tupdate<PlayerConfig>(playerConfig, `/gameState/players/${playerId}`);\n\t};\n\n\tconst onStartGame = () => {\n\t\tupdate({\n\t\t\tstarted: true,\n\t\t});\n\t};\n\n\tconst onEndGame = () => {\n\t\tupdate({\n\t\t\tstarted: false,\n\t\t});\n\t};\n\n\tconst onPlayerExit = (playerId: PlayerId) => {\n\t\t// remove as active player\n\t\tremove(`/gamePlayers/${playerId}`);\n\t\t// remove him from the game state\n\t\tremove(`/gameState/players/${playerId}`);\n\n\t\tif (game.gamePlayers) {\n\t\t\tconst playerLength = Object.keys(game.gamePlayers).length;\n\t\t\t// 1 <= because the state won't be updated just yet\n\t\t\tif (playerLength <= 1) {\n\t\t\t\tremoveOnlineGame(id);\n\t\t\t\t// 2 <= because the state won't be updated just yet\n\t\t\t\t// ??!!: Is this necessary? Change this when restart is added\n\t\t\t} else if (playerLength <= 2) {\n\t\t\t\tonEndGame();\n\t\t\t}\n\t\t}\n\t};\n\n\tconst onPlayerDeath = (playerId: PlayerId) => {\n\t\tupdate<OnlineGame['gamePlayers']>(\n\t\t\t{\n\t\t\t\t[playerId]: PlayerCondition.Dead,\n\t\t\t},\n\t\t\t'/gamePlayers'\n\t\t);\n\t};\n\n\tconst _game: OnlineGame = {\n\t\tgameId: id,\n\t\tgameState: {\n\t\t\tplayers: game?.gameState?.players || defaultGameState.players,\n\t\t\tgameMap: game?.gameState?.gameMap || defaultGameState.gameMap,\n\t\t\tbombs: game?.gameState?.bombs || defaultGameState.bombs,\n\t\t\tpowerUps: game?.gameState?.powerUps || defaultGameState.powerUps,\n\t\t\tis3D: game?.gameState?.is3D || defaultGameState.is3D,\n\t\t\tisSideView:\n\t\t\t\tgame?.gameState?.isSideView || defaultGameState.isSideView,\n\t\t\tanimationCounter:\n\t\t\t\tgame?.gameState?.animationCounter ||\n\t\t\t\tdefaultGameState.animationCounter,\n\t\t\tconfig: game?.gameState?.config || defaultGameState.config,\n\t\t},\n\t\tgamePlayers: game?.gamePlayers || {},\n\t\tstarted: game?.started || false,\n\t};\n\n\treturn {\n\t\tgame: _game,\n\t\tpending,\n\t\terror,\n\t\tisReady: !pending && !error,\n\t\tonPlayerJoin,\n\t\tonPlayerExit,\n\t\tonStartGame,\n\t\tonPlayerDeath,\n\t};\n};\n\nexport default useWatchOnlineGame;\n","import {\n\tuniqueNamesGenerator,\n\tConfig,\n\tcolors,\n\tanimals,\n} from 'unique-names-generator';\n\nconst customConfig: Config = {\n\tdictionaries: [colors, animals],\n\tseparator: '-',\n};\n\nconst getRandomName = () => uniqueNamesGenerator(customConfig);\n\nexport default getRandomName;\n","import { useFirebaseConnect } from 'react-redux-firebase';\nimport { GameState } from 'store/redux/reducers/game/types';\nimport { OnlineGame, OnlineGameId } from 'containers/Game/types';\nimport getRandomName from 'utils/random-name-generator';\nimport useFirebaseUtils from './useFirebaseUtils';\n\nconst useOnlineGameActions = () => {\n\tconst refKey = `online`;\n\tuseFirebaseConnect(refKey);\n\tconst { create, update, remove } = useFirebaseUtils<OnlineGame>(refKey);\n\n\tconst createOnlineGame = async (gameState: GameState) => {\n\t\tconst randomName = getRandomName();\n\t\t// create the game\n\t\tawait create(\n\t\t\t{\n\t\t\t\tgameState,\n\t\t\t\tstarted: false,\n\t\t\t},\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t\trandomName\n\t\t);\n\n\t\t// TODO: error checking..\n\t\t// set its id\n\t\tawait update(\n\t\t\t{\n\t\t\t\tgameId: randomName as OnlineGameId,\n\t\t\t},\n\t\t\t`/${randomName}`\n\t\t);\n\t\treturn randomName;\n\t};\n\n\tconst removeOnlineGame = async (gameId: OnlineGameId) => {\n\t\tremove(`/${gameId}`);\n\t};\n\n\treturn {\n\t\tcreateOnlineGame,\n\t\tremoveOnlineGame,\n\t};\n};\n\nexport default useOnlineGameActions;\n","import { OnlineGame, PlayerId } from 'containers/Game/types';\nimport {\n\tCharacterIconProps,\n\tCharacterIcon,\n\tGhostIcon,\n} from 'containers/RoomCreator/icons';\nimport { Grid } from '@material-ui/core';\nimport ContainerWithCenteredItems from 'components/ContainerWithCenteredItems';\nimport Spacer from 'components/Spacer';\nimport TooltipButton from 'components/TooltipButton';\nimport { PlayerCondition } from 'enums';\nimport styled, { css } from 'styled-components';\nimport { ghostAnimation } from 'animations';\nimport theme from 'theme';\n\ninterface Props {\n\tplayers: OnlineGame['gamePlayers'];\n\tcurrentOnlinePlayerId?: PlayerId;\n\tcanStart?: boolean;\n\tonStartGame?: CallableFunction;\n\tisGameEnd?: boolean;\n}\n\nconst FloatingGhostIcon = styled(GhostIcon)<{\n\t$size: number;\n\t$playerId: PlayerId;\n}>`\n\t${({ $size, $playerId }) => {\n\t\tconst { warning, info, success, error } = theme.palette.color;\n\t\tconst colors = [warning, info, success, error];\n\t\tconst color = colors[Number($playerId.replace('P', '')) - 1];\n\n\t\treturn css`\n\t\t\tfont-size: ${$size}px;\n\t\t\tanimation: ${ghostAnimation($size, color)} 3s infinite;\n\t\t\tborder-radius: 50%;\n\t\t`;\n\t}}\n`;\n\nconst PlayerDisplay = ({\n\tplayers,\n\tcurrentOnlinePlayerId,\n\tonStartGame,\n\tisGameEnd = false,\n\tcanStart = false,\n}: Props) => {\n\treturn (\n\t\t<ContainerWithCenteredItems container>\n\t\t\t{onStartGame && (\n\t\t\t\t<>\n\t\t\t\t\t<Spacer spacing=\"5\" />\n\t\t\t\t\t<ContainerWithCenteredItems container>\n\t\t\t\t\t\t<Grid container justify=\"center\" item xs={12} sm={4}>\n\t\t\t\t\t\t\t<TooltipButton\n\t\t\t\t\t\t\t\ttext=\"Start\"\n\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\tbg=\"primary\"\n\t\t\t\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\t\t\t\tdisabled={!canStart}\n\t\t\t\t\t\t\t\tonClick={onStartGame as ReactOnButtonClick}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Grid>\n\t\t\t\t\t</ContainerWithCenteredItems>\n\t\t\t\t</>\n\t\t\t)}\n\t\t\t<Spacer spacing=\"15\" />\n\t\t\t<Grid container justify=\"space-between\" item xs={12} sm={8}>\n\t\t\t\t{Object.keys(players)\n\t\t\t\t\t.sort()\n\t\t\t\t\t.map(id => {\n\t\t\t\t\t\tconst isCurrentPlayer = currentOnlinePlayerId === id;\n\t\t\t\t\t\tconst isGameEndDeadCharacter =\n\t\t\t\t\t\t\tisGameEnd &&\n\t\t\t\t\t\t\tplayers[id as PlayerId] === PlayerCondition.Dead;\n\n\t\t\t\t\t\tlet size = 50;\n\t\t\t\t\t\tlet isWalking = false;\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t(isCurrentPlayer &&\n\t\t\t\t\t\t\t\t(!isGameEnd || !isGameEndDeadCharacter)) ||\n\t\t\t\t\t\t\t(!isCurrentPlayer &&\n\t\t\t\t\t\t\t\tisGameEnd &&\n\t\t\t\t\t\t\t\t!isGameEndDeadCharacter)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tsize = 80;\n\t\t\t\t\t\t\tisWalking = true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst props: CharacterIconProps &\n\t\t\t\t\t\t\tPartial<JSX.Element> = {\n\t\t\t\t\t\t\tkey: id,\n\t\t\t\t\t\t\tsize,\n\t\t\t\t\t\t\tname: id,\n\t\t\t\t\t\t\tid: id as PlayerId,\n\t\t\t\t\t\t\tshowName: true,\n\t\t\t\t\t\t\tisWalking,\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\treturn isGameEndDeadCharacter ? (\n\t\t\t\t\t\t\t<FloatingGhostIcon\n\t\t\t\t\t\t\t\tid={id}\n\t\t\t\t\t\t\t\tkey={id}\n\t\t\t\t\t\t\t\t$size={size}\n\t\t\t\t\t\t\t\t$playerId={id as PlayerId}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<CharacterIcon {...props} />\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t</Grid>\n\t\t\t<Spacer spacing=\"5\" />\n\t\t</ContainerWithCenteredItems>\n\t);\n};\n\nexport type { Props as PlayerDisplayProps };\nexport default PlayerDisplay;\n","import { useEffect } from 'react';\n\nconst noop = () => null;\ntype UseBeforeLoadCb = (this: Window, ev: BeforeUnloadEvent) => any;\n\nconst useBeforeUnload = (\n\tonBeforeUnload: UseBeforeLoadCb,\n\tonUnload: UseBeforeLoadCb = noop\n) => {\n\tuseEffect(() => {\n\t\twindow.addEventListener('beforeunload', onBeforeUnload);\n\t\twindow.addEventListener('unload', onUnload);\n\t\treturn () => {\n\t\t\twindow.removeEventListener('beforeunload', onBeforeUnload);\n\t\t\twindow.removeEventListener('unload', onUnload);\n\t\t};\n\t});\n};\n\nexport default useBeforeUnload;\n","import { useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { OnlineGameId, PlayerId } from 'containers/Game/types';\nimport { BASE_PATH } from 'routes/constants';\nimport useWatchOnlineGame from 'store/firebase/hooks/useWatchOnlineGame';\nimport useBeforeUnload from './useBeforeUnload';\n\nconst useOnPlayerExitOnline = (gameId: OnlineGameId, playerId?: PlayerId) => {\n\tconst { onPlayerExit } = useWatchOnlineGame(gameId);\n\tconst { listen } = useHistory();\n\tuseBeforeUnload(() => {\n\t\tif (!playerId) return;\n\t\tonPlayerExit(playerId);\n\t});\n\n\t/** @see https://help.mouseflow.com/en/articles/4310818-tracking-url-changes-with-react#:~:text=2.%20Listening%20for%20route%20changes */\n\tuseEffect(() => {\n\t\treturn listen(({ pathname }) => {\n\t\t\tif (!playerId) return;\n\t\t\t// if we are redirected to the game, don't trigger this\n\t\t\tif (pathname === `${BASE_PATH}/online/${gameId}`) return;\n\t\t\t// end game screen should not trigger this either\n\t\t\tif (pathname === `${BASE_PATH}/game-end`) return;\n\t\t\tonPlayerExit(playerId);\n\t\t});\n\t}, [gameId, listen, onPlayerExit, playerId]);\n};\n\nexport default useOnPlayerExitOnline;\n"],"sourceRoot":""}