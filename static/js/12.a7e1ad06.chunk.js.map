{"version":3,"sources":["hooks/useOnGameEndLocal.tsx","store/redux/hooks/useGameProvider.tsx","store/redux/reducers/game/actions.tsx","store/redux/hooks/useLocalGame.tsx","routes/pages/Local.tsx","animations.tsx","utils/index.ts","containers/Game/components/TileIcon.tsx","containers/Game/components/DeadCharacter.tsx","containers/Game/components/PowerUp/icons.tsx","containers/Game/components/SpriteCharacter.tsx","containers/Game/components/character-shadow.png","containers/Game/components/character-skin-default.png","store/firebase/hooks/useFirebaseUtils.tsx","components/NoAccess/NoAccess.tsx","store/redux/reducers/firebase/selectors.tsx","store/firebase/hooks/useWatchOnlineGame.tsx","utils/random-name-generator.ts","store/firebase/hooks/useOnlineGameActions.tsx","hooks/useInterval.tsx","hooks/usePrevious.tsx","utils/npc.ts","store/redux/hooks/usePlayerEvents.tsx","components/Button/Button.tsx","containers/Game/GameContainer.tsx","containers/Game/GameButton.tsx","containers/Game/GameSettings.tsx","hooks/useIsUnmounted.tsx","containers/Game/components/Cube.tsx","containers/Game/components/Bomb.tsx","containers/Game/components/Character.tsx","containers/Game/GameContent.tsx","containers/Game/components/Tile.tsx","containers/Game/components/PowerUp/PowerUp.tsx","containers/Game/components/Map.tsx","containers/Game/GameMap.tsx","containers/Game/Game.tsx"],"names":["useOnGameEndLocal","gameState","onGameEnd","push","useHistory","players","config","powerUpConfig","powerUps","exploding","duration","bomb","gameEndCondition","GameEndCondition","Lose","mappedPlayers","mapPlayersToGamePlayers","P1","P2","PlayerCondition","Alive","isNPC","Win","useEffect","alivePlayers","Object","values","filter","playerCondition","length","setTimeout","BASE_PATH","endGame","currentOnlinePlayerId","keys","useGameProvider","dispatch","useDispatch","useSelector","makeSelectGameConfig","sizes","blockTileChance","tiles","makeSelectGamePlayers","updateGameSettings","useCallback","payload","type","SET_GAME_STATE","setGameState","startGame","generateDefaultGameState","updateGameMap","props","SET_GAME_MAP","generateNewCollisionCoordinates","gameMap","generateRandomGameMap","animate","updatePlayerDirection","direction","id","CHANGE_DIRECTION","updatePlayerIsWalking","isWalking","CHANGE_IS_WALKING","makeMove","MAKE_MOVE","triggerMove","onComplete","TRIGGER_MOVE","dropBomb","playerId","DROP_BOMB","triggerExplosion","bombId","cb","TRIGGER_EXPLOSION","triggerExplosionInGame","onExplosionComplete","ON_EXPLOSION_COMPLETE","triggerAnimation","TRIGGER_GAME_ANIMATION","toggleDimension","TOGGLE_GAME_DIMENSION","togglePerspective","TOGGLE_GAME_PERSPECTIVE","toggleTwoPlayer","TOGGLE_GAME_TWO_PLAYER","toggleNPC","TOGGLE_GAME_NPC","useLocalGame","gameConfig","provider","state","makeSelectGameState","gameStarted","useRef","current","GameType","Local","gamePlayers","reduce","acc","Wrapper","gameProps","Game","location","LoadingIndicator","bounceAnimation","withOpacity","keyframes","ghostAnimation","size","color","Math","ceil","sleep","Promise","r","wrapPreventFocusLock","e","currentTarget","blur","doesNotExist","value","undefined","findEnumKeyFromValue","enumerable","key","indexOf","TileIcon","styled","div","$size","$animationDelay","$top","$left","css","DeadIcon","icon","faBookDead","DeadCharacter","explodingDuration","coordinates","top","left","onDeathAnimationComplete","theme","palette","default","icons","PowerUp","Life","success","faHeart","BombCount","error","faBomb","BombSize","warning","faPrescriptionBottleAlt","MovementSpeed","info","faShoePrints","$name","pixelMultiplier","spriteSize","spriteSheetSize","spriteSheetSquareSize","translateDiff","topDiff","min","labelFontSize","labelTopDiff","floor","labelMaxWidth","spriteSizing","spriteSheetSizing","useSpriteCharacterAction","shouldBindEvent","keyboardConfig","onPlayerIsWalking","setDirection","setIsWalking","lastMovementTime","Date","getTime","handleKeyDown","newDirection","getMoveDirectionFromKeyboardCode","code","getDirection","updateDirection","handleKeyUp","delayedCurrentTime","document","addEventListener","removeEventListener","SpriteCharacter","name","style","highlight","defaultIsWalking","defaultDirection","Direction","DOWN","rest","useState","eventDirection","setEventDirection","eventIsWalking","setEventIsWalking","className","data-facing","data-walking","toString","data-highlight","src","alt","useFirebaseUtils","baseRefPath","firebase","useFirebase","useFirebaseConnect","getPath","subPath","create","a","newProps","subPaths","uniqueSet","dataSnapshot","onSuccess","onError","read","pending","isLoaded","isEmpty","update","remove","H1Wrapper","H1","NoAccess","children","message","PageContainer","fullHeight","Spacer","spacing","selectFirebase","LazyJoin","loadable","defaultGameState","useWatchOnlineGame","refKey","removeOnlineGame","useOnlineGameActions","onlineGameFromFirebase","createSelector","online","data","makeSelectOnlineGame","noWrapper","game","gameId","bombs","is3D","isSideView","animationCounter","started","isReady","onPlayerJoin","playerConfig","generatePlayer","onPlayerExit","playerLength","onStartGame","onPlayerDeath","Dead","customConfig","dictionaries","colors","animals","separator","getRandomName","uniqueNamesGenerator","createOnlineGame","randomName","useInterval","callback","delay","shouldStop","savedCallback","clearLastInterval","clearInterval","triggerCb","setInterval","usePrevious","ref","window","NPC_DEBUG","Store","NPCScore","log","label","console","Boolean","isDifferentSquare","newCoordinates","oldCoordinates","newYSquare","ySquare","newXSquare","xSquare","oldYSquare","oldXSquare","isSquareAPossibleFire","currentSquareCoordinates","_fireCoordinates","forEach","coordinatesToSetOnFire","getExplosionResults","getPoweredUpValue","defaults","flat","squareCoordinates","findIndex","fireSquareCoordinates","isAdjacent","dropBombAndRunOrScoreTarget","targetScore","runScore","currentTime","lastBombTime","bombDuration","generateScore","level","isSquareOutOfBoundaries","map","square","newSquare","IsPossibleFireExit","IsDanger","includes","IsPowerUp","IsStuck","Tile","Empty","IsEmptyTile","Player","score","IsPlayer","Breaking","IsBreakingTile","NonBreaking","IsNonBreakingTile","IsNonAdjacentNonBreakingTile","generateMovementTree","parentId","playerMovementTree","_newYSquare","_newXSquare","LEFT","UP","RIGHT","hasChildren","findNodeWithHighestScore","movementNodes","retVal","getRandomInt","groupMovementNodesByParentId","movementNodesGroupedById","movementNode","movementNodeParentId","getTotalScoreOfAllNodes","movementTree","validMovementNodes","movementNodesGroupedByParentId","entries","groupParentId","_groupParentId","Number","nodeWithHighestScore","parentNodes","some","parentNode","findBestMove","currentCoordinates","usePlayerRefs","playerRefs","getElementById","P3","P4","recalculate","useTimeOutRef","useCanMove","timeOutRef","npc","npcState","newTime","movementSpeed","useKeyboardEvent","onKeyDown","onKeyUp","keyMap","handleKeyEvent","isKeyDown","CODE_SPACE","preventDefault","registerKeys","canPlayerTakeAction","player","isPlayerDead","usePlayerInterval","playerActionSpeedOrNull","useMemo","playerState","usePlayerActionSpeed","MAX_SAFE_INTEGER","handleBombForPlayers","keyEventCode","mapAllPossibleKeyboardKeysForAction","IntervalWrapper","usePlayerEvents","gameType","_players","handleActions","previousIs3D","canMove","move","playerKeyboardConfig","directions","getMoveDirectionFromKeyMap","useEvents","handleNpcActions","pId","currentPlayer","getSquareCoordinatesFromSquareOrTopLeftCoordinates","movement","bestMovementNode","npcAction","Container","button","$variant","shape","borderRadius","padding","transition","hover","Button","forwardRef","variant","memo","SettingsAndMap","CenteredDiv","$is3D","GameContainer","GameButton","active","onClick","width","wordWrap","marginBottom","GameSettings","buttons","disabled","useIsUnmounted","isMounted","CuboidSide","Cuboid","Cube","backgroundColor","collisionIndex","_className","height","Array","fill","_","ind","getTransform","deg","incrementalSpeedRotationKeyframes","join","FiringBomb","FiringCubeBomb","Bomb","firingDuration","tileSize","ExplosionState","Firing","explosionState","setExplosionState","bombIds","Exploding","bId","kaboom","bombSize","bombPadding","bombStyleProps","position","animationDuration","Explosive","Character","_top","_left","transform","CUBE_BASE_TRANSFORM","GameContent","isAlive","isSteppingOnFire","isPlayerSteppingOnFire","character","tile","bombProps","explosionSize","firing","attrs","$color","background","secondary","primary","$collisionIndex","$animate","$fireSquare","fireSquare","x","y","rotateFrom","rotateTo","borderRadiusFrom","borderRadiusTo","FireHorizontal","FireVertical","fireAnimation","Icon","$mapSize","$tileSize","$isTopView","Map","mapSize","isTopView","shouldAnimate","outer","outerInd","innerInd","hasCollision","TileEnum","squareSize","isPowerUp","FireCore","GameMap","playerIntervals","gameContainerProps","gameSettingProps","gameMapProps","gameContentProps","useGameProps"],"mappings":"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","file":"static/js/12.a7e1ad06.chunk.js","sourcesContent":["import { PlayerId } from 'containers/Game/types';\nimport { GameEndCondition, PlayerCondition } from 'enums';\nimport { useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { BASE_PATH } from 'routes/constants';\nimport { ReactRouterState } from 'routes/types';\nimport { GameState } from 'store/redux/reducers/game/types';\nimport { mapPlayersToGamePlayers } from 'utils/game';\n\nconst useOnGameEndLocal = (\n\tgameState: GameState,\n\tonGameEnd: CallableFunction\n) => {\n\tconst { push } = useHistory<ReactRouterState>();\n\n\tconst {\n\t\tplayers,\n\t\tconfig: {\n\t\t\tpowerUps: powerUpConfig,\n\t\t\tduration: {\n\t\t\t\tbomb: { exploding },\n\t\t\t},\n\t\t},\n\t} = gameState;\n\tlet gameEndCondition = GameEndCondition.Lose;\n\n\tconst mappedPlayers = mapPlayersToGamePlayers(players, powerUpConfig);\n\n\tconst { P1, P2 } = mappedPlayers;\n\t// P1 or P2 alive will display You have won as both players are on the same screen\n\tif (\n\t\tP1 === PlayerCondition.Alive ||\n\t\t// P2 is a Human Player\n\t\t(P2 && !players.P2?.isNPC && P2 === PlayerCondition.Alive)\n\t) {\n\t\tgameEndCondition = GameEndCondition.Win;\n\t}\n\n\tuseEffect(() => {\n\t\tconst alivePlayers = Object.values(mappedPlayers).filter(\n\t\t\tplayerCondition => playerCondition === PlayerCondition.Alive\n\t\t);\n\n\t\tif (alivePlayers.length > 1) return;\n\n\t\tsetTimeout(() => {\n\t\t\tonGameEnd();\n\t\t\tpush(`${BASE_PATH}/game-end`, {\n\t\t\t\tendGame: {\n\t\t\t\t\tplayers: mappedPlayers,\n\t\t\t\t\tcurrentOnlinePlayerId: Object.keys(\n\t\t\t\t\t\talivePlayers\n\t\t\t\t\t)[0] as PlayerId,\n\t\t\t\t\tgameEndCondition,\n\t\t\t\t},\n\t\t\t});\n\t\t}, exploding * 1000 + 1000);\n\t}, [exploding, gameEndCondition, mappedPlayers, onGameEnd, push]);\n};\n\nexport default useOnGameEndLocal;\n","import { useCallback } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport {\n\tsetGameState,\n\tsetGameMap,\n\ttriggerGameAnimation,\n\ttoggleGamePerspective,\n\ttoggleGameDimension,\n\ttoggleGameNPC,\n\ttoggleGameTwoPlayer,\n\tmakeMoveInGame,\n\tdropBombInGame,\n\tonExplosionCompleteInGame,\n\ttriggerMoveInGame,\n\ttriggerExplosionInGame,\n\tchangePlayerDirectionInGame,\n\tchangePlayerIsWalkingInGame,\n} from 'store/redux/reducers/game/actions';\nimport {\n\tAnimatableGameMap,\n\tBombFn,\n\tBombId,\n\tGameConfig,\n\tGameState,\n\tOnMoveProps,\n\tOnTriggerMove,\n} from 'store/redux/reducers/game/types';\nimport { generateDefaultGameState, generateRandomGameMap } from 'utils/game';\nimport {\n\tmakeSelectGameConfig,\n\tmakeSelectGamePlayers,\n} from 'store/redux/reducers/game/selectors';\nimport { OnDropBomb, PlayerId } from 'containers/Game/types';\nimport { Direction } from 'enums';\n\nconst useGameProvider = () => {\n\tconst dispatch = useDispatch();\n\tconst {\n\t\tsizes,\n\t\ttiles: { blockTileChance },\n\t} = useSelector(makeSelectGameConfig());\n\tconst players = useSelector(makeSelectGamePlayers());\n\n\tconst updateGameSettings = useCallback(\n\t\t(payload: GameState) => dispatch(setGameState(payload)),\n\t\t[dispatch]\n\t);\n\n\tconst startGame = useCallback(\n\t\t(payload: GameConfig) => {\n\t\t\tconst gameState = generateDefaultGameState(payload);\n\t\t\tupdateGameSettings(gameState);\n\t\t},\n\t\t[updateGameSettings]\n\t);\n\n\tconst updateGameMap = useCallback(\n\t\t(props: AnimatableGameMap) => dispatch(setGameMap(props)),\n\t\t[dispatch]\n\t);\n\n\tconst generateNewCollisionCoordinates = useCallback(\n\t\t() =>\n\t\t\tupdateGameMap({\n\t\t\t\tgameMap: generateRandomGameMap(sizes, blockTileChance, players),\n\t\t\t\tanimate: true,\n\t\t\t}),\n\t\t[blockTileChance, sizes, players, updateGameMap]\n\t);\n\n\t// #region GAME ACTIONS\n\tconst updatePlayerDirection = useCallback(\n\t\t(direction: Direction, id: PlayerId) => {\n\t\t\tdispatch(changePlayerDirectionInGame({ direction, id }));\n\t\t},\n\t\t[dispatch]\n\t);\n\n\tconst updatePlayerIsWalking = useCallback(\n\t\t(isWalking: boolean, id: PlayerId) => {\n\t\t\tdispatch(changePlayerIsWalkingInGame({ isWalking, id }));\n\t\t},\n\t\t[dispatch]\n\t);\n\n\tconst makeMove = useCallback(\n\t\t(props: OnMoveProps) => dispatch(makeMoveInGame(props)),\n\t\t[dispatch]\n\t);\n\n\tconst triggerMove = useCallback<OnTriggerMove>(\n\t\tprops =>\n\t\t\tdispatch(\n\t\t\t\ttriggerMoveInGame({\n\t\t\t\t\t...props,\n\t\t\t\t\tonComplete: makeMove,\n\t\t\t\t})\n\t\t\t),\n\t\t[dispatch, makeMove]\n\t);\n\n\tconst dropBomb = useCallback<OnDropBomb>(\n\t\tplayerId => dispatch(dropBombInGame(playerId)),\n\t\t[dispatch]\n\t);\n\n\tconst triggerExplosion = useCallback<BombFn>(\n\t\t(bombId, cb) => dispatch(triggerExplosionInGame(bombId, cb)),\n\t\t[dispatch]\n\t);\n\n\tconst onExplosionComplete = useCallback(\n\t\t(bombId: BombId) => {\n\t\t\tdispatch(onExplosionCompleteInGame(bombId));\n\t\t},\n\t\t[dispatch]\n\t);\n\t// #endregion\n\n\t// #region GAME SETTINGS\n\tconst triggerAnimation = useCallback(\n\t\t() => dispatch(triggerGameAnimation()),\n\t\t[dispatch]\n\t);\n\n\tconst toggleDimension = useCallback(() => dispatch(toggleGameDimension()), [\n\t\tdispatch,\n\t]);\n\n\tconst togglePerspective = useCallback(\n\t\t() => dispatch(toggleGamePerspective()),\n\t\t[dispatch]\n\t);\n\n\tconst toggleTwoPlayer = useCallback(() => dispatch(toggleGameTwoPlayer()), [\n\t\tdispatch,\n\t]);\n\n\tconst toggleNPC = useCallback(() => dispatch(toggleGameNPC()), [dispatch]);\n\t// #endregion\n\n\treturn {\n\t\tstartGame,\n\t\tupdateGameSettings,\n\t\tgenerateNewCollisionCoordinates,\n\t\t// GAME ACTIONS\n\t\tupdatePlayerDirection,\n\t\tupdatePlayerIsWalking,\n\t\tmakeMove,\n\t\ttriggerMove,\n\t\tdropBomb,\n\t\ttriggerExplosion,\n\t\tonExplosionComplete,\n\t\t// GAME SETTINGS\n\t\ttriggerAnimation,\n\t\ttoggleDimension,\n\t\ttogglePerspective,\n\t\ttoggleTwoPlayer,\n\t\ttoggleNPC,\n\t};\n};\n\ntype GameProvider = ReturnType<typeof useGameProvider>;\n\nexport type { GameProvider };\nexport default useGameProvider;\n","import {\n\tDROP_BOMB,\n\tCHANGE_DIRECTION,\n\tCHANGE_IS_WALKING,\n\tMAKE_MOVE,\n\tON_EXPLOSION_COMPLETE,\n\tSET_GAME_MAP,\n\tSET_GAME_STATE,\n\tTOGGLE_GAME_DIMENSION,\n\tTOGGLE_GAME_NPC,\n\tTOGGLE_GAME_PERSPECTIVE,\n\tTOGGLE_GAME_TWO_PLAYER,\n\tTRIGGER_EXPLOSION,\n\tTRIGGER_GAME_ANIMATION,\n\tTRIGGER_MOVE,\n} from './constants';\nimport { GameActionFn } from './types';\n\nconst setGameState: GameActionFn = payload => ({\n\ttype: SET_GAME_STATE,\n\tpayload,\n});\n\nconst setGameMap: GameActionFn = payload => ({\n\ttype: SET_GAME_MAP,\n\tpayload,\n});\n\n// #region GAME ACTIONS\nconst changePlayerDirectionInGame: GameActionFn = payload => ({\n\ttype: CHANGE_DIRECTION,\n\tpayload,\n});\n\nconst changePlayerIsWalkingInGame: GameActionFn = payload => ({\n\ttype: CHANGE_IS_WALKING,\n\tpayload,\n});\n\nconst makeMoveInGame: GameActionFn = payload => ({\n\ttype: MAKE_MOVE,\n\tpayload,\n});\n\nconst triggerMoveInGame: GameActionFn = payload => ({\n\ttype: TRIGGER_MOVE,\n\tpayload,\n});\n\nconst dropBombInGame: GameActionFn = payload => ({\n\ttype: DROP_BOMB,\n\tpayload,\n});\n\nconst triggerExplosionInGame: GameActionFn = (payload, cb) => ({\n\ttype: TRIGGER_EXPLOSION,\n\tpayload,\n\tcb,\n});\n\nconst onExplosionCompleteInGame: GameActionFn = payload => ({\n\ttype: ON_EXPLOSION_COMPLETE,\n\tpayload,\n});\n// #endregion\n\n// #region GAME SETTINGS\nconst triggerGameAnimation: GameActionFn = () => ({\n\ttype: TRIGGER_GAME_ANIMATION,\n});\n\nconst toggleGameDimension: GameActionFn = () => ({\n\ttype: TOGGLE_GAME_DIMENSION,\n});\n\nconst toggleGamePerspective: GameActionFn = () => ({\n\ttype: TOGGLE_GAME_PERSPECTIVE,\n});\n\nconst toggleGameTwoPlayer: GameActionFn = () => ({\n\ttype: TOGGLE_GAME_TWO_PLAYER,\n});\n\nconst toggleGameNPC: GameActionFn = () => ({\n\ttype: TOGGLE_GAME_NPC,\n});\n// #endregion\n\nexport {\n\tsetGameState,\n\tsetGameMap,\n\t// GAME ACTIONS\n\tchangePlayerDirectionInGame,\n\tchangePlayerIsWalkingInGame,\n\tmakeMoveInGame,\n\ttriggerMoveInGame,\n\tdropBombInGame,\n\ttriggerExplosionInGame,\n\tonExplosionCompleteInGame,\n\t// GAME SETTINGS\n\ttriggerGameAnimation,\n\ttoggleGameDimension,\n\ttoggleGamePerspective,\n\ttoggleGameTwoPlayer,\n\ttoggleGameNPC,\n};\n","import { GameApiHookLocal, PlayerId } from 'containers/Game/types';\nimport { GameType, PlayerCondition } from 'enums';\nimport { useEffect, useRef } from 'react';\nimport { useSelector } from 'react-redux';\nimport { useHistory } from 'react-router-dom';\nimport { BASE_PATH } from 'routes/constants';\nimport makeSelectGameState from '../reducers/game/selectors';\nimport useGameProvider from './useGameProvider';\n\nconst useLocalGame: GameApiHookLocal = gameConfig => {\n\tconst { push } = useHistory();\n\tconst provider = useGameProvider();\n\tconst state = useSelector(makeSelectGameState());\n\n\tconst gameStarted = useRef(false);\n\n\tuseEffect(() => {\n\t\tif (gameStarted.current) return;\n\t\tif (!gameConfig) return;\n\t\tprovider.startGame(gameConfig);\n\t\tgameStarted.current = true;\n\t});\n\n\tif (!gameConfig) {\n\t\tpush(`${BASE_PATH}/room-creator/local`);\n\t\treturn null; // to satisfy lint\n\t}\n\n\treturn {\n\t\tprovider,\n\t\tstate,\n\t\ttype: GameType.Local,\n\t\tgamePlayers: Object.keys(state.players).reduce<\n\t\t\tRecord<PlayerId, PlayerCondition>\n\t\t>((acc, playerId) => {\n\t\t\tacc[playerId as PlayerId] = PlayerCondition.Alive;\n\t\t\treturn acc;\n\t\t}, {} as Record<PlayerId, PlayerCondition>),\n\t};\n};\n\nexport default useLocalGame;\n","import LoadingIndicator from 'components/LoadingIndicator';\nimport Game from 'containers/Game';\nimport { GameApi } from 'containers/Game/types';\nimport useOnGameEndLocal from 'hooks/useOnGameEndLocal';\nimport { RouteComponentPropsWithLocationState } from 'routes/types';\nimport useLocalGame from 'store/redux/hooks/useLocalGame';\n\n// need to wrap it as game props will be null if the user goes to\n// /local without going through /room-creator\nconst Wrapper = ({ gameProps }: { gameProps: GameApi }) => {\n\t// bug: old game state is passed, since the players are\n\t// already dead, ends the game. This will be fixed once\n\t// the redux store is injected rather then set on default\n\t// temporary workaround: start the game again to clear\n\t// I could create a revivePlayer function but not now..\n\tuseOnGameEndLocal(gameProps.state, gameProps.provider.startGame);\n\n\treturn <Game {...gameProps} />;\n};\n\nconst Local = ({ location }: RouteComponentPropsWithLocationState) => {\n\tconst gameConfig = location?.state?.gameConfig;\n\tconst gameProps = useLocalGame(gameConfig);\n\n\treturn gameProps ? <Wrapper gameProps={gameProps} /> : <LoadingIndicator />;\n};\n\nexport default Local;\n","import { keyframes } from 'styled-components';\n\n/** @see https://codepen.io/nelledejones/pen/gOOPWrK#L68 */\nconst bounceAnimation = (withOpacity = false) => keyframes`\n\t0% { transform: scale(0, 0); }\n\t25% { transform: scale(0.9, 1.1); }\n\t50% { transform: scale(1.1, 0.9); }\n\t75% { transform: scale(0.95, 1.05); }\n\t100% { transform: scale(1, 1); ${(withOpacity && 'opacity: 1;') || ''} }\n`;\n\nconst ghostAnimation = (size: number, color: string) => keyframes`\n\t0%, 100% { \n\t\ttransform: translateY(0px); \n\t\tbox-shadow: 0 10px 10px #000000;\n\t}\n\t50% {\n\t\ttransform: translateY(-10px);\n\t\tbox-shadow: 0 20px ${Math.ceil(size / 6) + 10}px ${color};\n\t}\n`;\n\nexport { bounceAnimation, ghostAnimation };\n","const sleep = (duration = 1000) => {\n\treturn new Promise(r => {\n\t\tsetTimeout(r, duration);\n\t});\n};\n\n/**\n * Wraps the button on click with a blur event to undo auto on focus. This is\n * especially annoying when view is changed and the user hits the \"Space\"\n * button and it switches the view back as it's \"focus\"ed on.\n *\n * @param cb Curried function where callback is wrapped with this utility.\n * @returns Base event cb\n */\nconst wrapPreventFocusLock = (\n\tcb: (e: React.MouseEvent<HTMLButtonElement, MouseEvent>) => void\n) => (e: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\n\t// undo onFocus lock\n\te.currentTarget.blur();\n\tcb(e);\n};\n\nconst doesNotExist = (value: any) => value === null || value === undefined;\n\nconst findEnumKeyFromValue = (enumerable: object, key: string) => {\n\treturn Object.keys(enumerable)[Object.values(enumerable).indexOf(key)];\n};\n\nexport { sleep, wrapPreventFocusLock, doesNotExist, findEnumKeyFromValue };\n","import { bounceAnimation } from 'animations';\nimport styled, { css } from 'styled-components';\n\nconst TileIcon = styled.div<{\n\t$size: number;\n\t$top: number;\n\t$left: number;\n\t$animationDelay?: string;\n}>`\n\tposition: absolute;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\topacity: 0;\n\tsvg {\n\t\theight: 100% !important;\n\t\twidth: 100% !important;\n\t\tmax-width: 70%;\n\t\tmax-height: 80%;\n\t}\n\t${({ $size, $animationDelay, $top, $left }) => css`\n\t\ttop: ${$top}px;\n\t\tleft: ${$left}px;\n\t\twidth: ${$size}px;\n\t\theight: ${$size}px;\n\t\tanimation: ${bounceAnimation(true)} var(--block-animation-duration)\n\t\t\t${$animationDelay || ''} ease-out forwards;\n\t`}\n`;\n\nexport default TileIcon;\n","import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faBookDead } from '@fortawesome/free-solid-svg-icons';\nimport {\n\tFontAwesomeIconProps,\n\tPlayerId,\n\tTopLeftCoordinates,\n} from 'containers/Game/types';\nimport theme from 'theme';\nimport { GameConfigRanges } from 'store/redux/reducers/game/types';\nimport { useEffect } from 'react';\nimport TileIcon from './TileIcon';\nimport { SpriteCharacterProps } from './SpriteCharacter';\n\nconst DeadIcon = (props: FontAwesomeIconProps) => (\n\t<FontAwesomeIcon icon={faBookDead} {...props} />\n);\n\ninterface Props extends Omit<SpriteCharacterProps, 'onPlayerIsWalking'> {\n\texplodingDuration: GameConfigRanges.ExplodingDuration;\n\tcoordinates: TopLeftCoordinates;\n\tonDeathAnimationComplete?: (playerId: PlayerId) => void;\n}\n\nconst DeadCharacter = ({\n\tid,\n\t// name,\n\tsize,\n\texplodingDuration,\n\tcoordinates: { top, left },\n\tonDeathAnimationComplete,\n}: Props) => {\n\tuseEffect(() => {\n\t\tsetTimeout(() => {\n\t\t\tonDeathAnimationComplete?.(id);\n\t\t}, explodingDuration * 1000 + 1000);\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, []);\n\treturn (\n\t\t<TileIcon\n\t\t\t$top={top}\n\t\t\t$left={left}\n\t\t\t$size={size}\n\t\t\t$animationDelay={`${explodingDuration}s`}\n\t\t>\n\t\t\t<DeadIcon color={theme.palette.color.default} />\n\t\t\t{/* <div className=\"name\">{name}</div> */}\n\t\t</TileIcon>\n\t);\n};\n\nexport default DeadCharacter;\n","import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n\tfaShoePrints,\n\tfaHeart,\n\tfaBomb,\n\tfaPrescriptionBottleAlt,\n} from '@fortawesome/free-solid-svg-icons';\nimport { PowerUp } from 'enums';\nimport theme from 'theme';\nimport { FontAwesomeIconProps } from 'containers/Game/types';\n\nconst ShoePrintsIcon = (props: FontAwesomeIconProps) => (\n\t<FontAwesomeIcon icon={faShoePrints} {...props} />\n);\nconst HeartIcon = (props: FontAwesomeIconProps) => (\n\t<FontAwesomeIcon icon={faHeart} {...props} />\n);\nconst BombIcon = (props: FontAwesomeIconProps) => (\n\t<FontAwesomeIcon icon={faBomb} {...props} />\n);\nconst PrescriptionBottleAltIcon = (props: FontAwesomeIconProps) => (\n\t<FontAwesomeIcon icon={faPrescriptionBottleAlt} {...props} />\n);\n\nconst icons: Record<\n\tPowerUp,\n\t{ icon: (props: FontAwesomeIconProps) => JSX.Element; color: string }\n> = {\n\t[PowerUp.Life]: {\n\t\tcolor: theme.palette.color.success,\n\t\ticon: HeartIcon,\n\t},\n\t[PowerUp.BombCount]: {\n\t\tcolor: theme.palette.color.error,\n\t\ticon: BombIcon,\n\t},\n\t[PowerUp.BombSize]: {\n\t\tcolor: theme.palette.color.warning,\n\t\ticon: PrescriptionBottleAltIcon,\n\t},\n\t[PowerUp.MovementSpeed]: {\n\t\tcolor: theme.palette.color.info,\n\t\ticon: ShoePrintsIcon,\n\t},\n};\n\nexport default icons;\n","import { Direction } from 'enums';\nimport { useEffect, useRef, useState } from 'react';\nimport { getMoveDirectionFromKeyboardCode } from 'utils/game';\nimport styled, { css } from 'styled-components';\nimport theme from 'theme';\nimport { CharacterProps } from './Character';\nimport './SpriteCharacter.scss';\nimport spriteShadow from './character-shadow.png';\nimport spriteImage from './character-skin-default.png';\n\nconst SPRITE_SQUARE_SIZE = 32;\nconst Wrapper = styled.div<{ $size: number; $name: string }>`\n\t${({ $size, $name }) => {\n\t\t// CALCULATED\n\t\tconst pixelMultiplier = $size / SPRITE_SQUARE_SIZE;\n\t\tconst spriteSize = pixelMultiplier * SPRITE_SQUARE_SIZE;\n\t\tconst spriteSheetSize = spriteSize * 4;\n\t\tconst spriteSheetSquareSize = pixelMultiplier * -1 * SPRITE_SQUARE_SIZE;\n\t\tconst translateDiff = ($size / 4) * -1;\n\t\tconst topDiff = Math.min(-15, translateDiff * 2.5);\n\t\tconst labelFontSize = Math.min(30, Math.ceil(spriteSize / 6));\n\t\tconst labelTopDiff = Math.floor(spriteSize / (5 * 2));\n\t\t// const labelMaxWidth = Math.ceil(spriteSize * 0.8);\n\t\tconst labelMaxWidth = Math.floor(\n\t\t\t$name.length * 20 + (spriteSize * pixelMultiplier) / 10\n\t\t);\n\n\t\tconst spriteSizing = `\n\t\t\twidth: ${spriteSize}px;\n\t\t\theight: ${spriteSize}px;\n\t\t`;\n\t\tconst spriteSheetSizing = `\n\t\t\twidth: ${spriteSheetSize}px;\n\t\t\theight: ${spriteSheetSize}px;\n\t\t`;\n\n\t\treturn css`\n\t\t\tposition: absolute;\n\t\t\tz-index: 9999;\n\t\t\t${spriteSizing};\n\t\t\ttransition-duration: 450ms;\n\n\t\t\t&#P1 .name {\n\t\t\t\tbackground-color: ${theme.palette.color.warning};\n\t\t\t}\n\t\t\t&#P2 .name {\n\t\t\t\tbackground-color: ${theme.palette.color.info};\n\t\t\t}\n\t\t\t&#P3 .name {\n\t\t\t\tbackground-color: ${theme.palette.color.success};\n\t\t\t}\n\t\t\t&#P4 .name {\n\t\t\t\tbackground-color: ${theme.palette.color.error};\n\t\t\t}\n\n\t\t\t.character {\n\t\t\t\ttop: ${topDiff}px;\n\t\t\t\ttransform: translate(${translateDiff}px);\n\n\t\t\t\t${spriteSizing};\n\t\t\t\toverflow: hidden;\n\t\t\t\tposition: relative;\n\t\t\t\t/* MOVEMENT TRANSITION */\n\t\t\t\ttransition-duration: 400ms;\n\n\t\t\t\t& .name {\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\tleft: 0;\n\t\t\t\t\tright: 0;\n\t\t\t\t\ttop: ${labelTopDiff}px;\n\t\t\t\t\tfont-size: ${labelFontSize}px;\n\t\t\t\t\tmax-width: ${labelMaxWidth}px;\n\t\t\t\t\tfont-weight: bold;\n\t\t\t\t\tborder: 1px dashed white;\n\t\t\t\t\tborder-radius: 9999px;\n\t\t\t\t\topacity: 1;\n\t\t\t\t\tmargin: auto;\n\t\t\t\t\ttext-align: center;\n\t\t\t\t}\n\n\t\t\t\t& .shadow {\n\t\t\t\t\t${spriteSizing};\n\t\t\t\t\topacity: 0.75;\n\t\t\t\t}\n\n\t\t\t\t& .spritesheet {\n\t\t\t\t\t${spriteSheetSizing};\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\ttop: 0;\n\t\t\t\t\tleft: 0;\n\t\t\t\t}\n\n\t\t\t\t/* DIRECTION */\n\t\t\t\t&[data-facing='Right'] .spritesheet {\n\t\t\t\t\ttop: ${spriteSheetSquareSize * 1}px;\n\t\t\t\t}\n\t\t\t\t&[data-facing='Up'] .spritesheet {\n\t\t\t\t\ttop: ${spriteSheetSquareSize * 2}px;\n\t\t\t\t}\n\t\t\t\t&[data-facing='Left'] .spritesheet {\n\t\t\t\t\ttop: ${spriteSheetSquareSize * 3}px;\n\t\t\t\t}\n\n\t\t\t\t&[data-walking='true'] {\n\t\t\t\t\t/* MOVEMENT ANIMATION */\n\t\t\t\t\t.spritesheet {\n\t\t\t\t\t\tanimation: walkAnimation 0.6s steps(4) infinite;\n\t\t\t\t\t}\n\n\t\t\t\t\t/* SHADOW ANIMATION */\n\t\t\t\t\t.shadow {\n\t\t\t\t\t\tanimation: shadowAnimation 0.3s infinite;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/* HIGHLIGHT/DAMAGE ANIMATION */\n\t\t\t\t&[data-highlight='true'] .spritesheet {\n\t\t\t\t\tanimation: opacityAnimation 0.6s steps(4) infinite;\n\t\t\t\t}\n\t\t\t}\n\t\t`;\n\t}}\n`;\n\nconst ANIMATION_STOP_THROTTLE_DURATION = 200;\n\ninterface Props extends Omit<CharacterProps, 'tileSize' | 'is3D' | 'size'> {\n\t// size can be any number by default, unless it's a game character\n\tsize: number;\n}\n\ntype UseSpriteCharacterAction = Omit<Props, 'coordinates' | 'name' | 'size'> & {\n\tshouldBindEvent: boolean;\n\t// setters\n\tsetDirection: React.Dispatch<React.SetStateAction<Direction>>;\n\tsetIsWalking: React.Dispatch<React.SetStateAction<boolean>>;\n};\n\nconst useSpriteCharacterAction = ({\n\tid,\n\tshouldBindEvent,\n\tkeyboardConfig,\n\t// state setter\n\tonPlayerIsWalking,\n\t// setters\n\tsetDirection,\n\tsetIsWalking,\n}: UseSpriteCharacterAction) => {\n\tconst lastMovementTime = useRef(new Date().getTime());\n\n\tuseEffect(() => {\n\t\t// ignore the npc action\n\t\tconst getDirection = (e: KeyboardEvent) => {\n\t\t\treturn keyboardConfig\n\t\t\t\t? getMoveDirectionFromKeyboardCode(e.code, keyboardConfig)\n\t\t\t\t: null;\n\t\t};\n\n\t\tconst updateDirection = (newDirection: Direction) => {\n\t\t\tsetDirection(newDirection);\n\t\t};\n\n\t\tconst handleKeyDown = (e: KeyboardEvent) => {\n\t\t\tif (!shouldBindEvent) return;\n\n\t\t\tconst newDirection = getDirection(e);\n\t\t\tif (!newDirection) {\n\t\t\t\tonPlayerIsWalking?.(false, id);\n\t\t\t\tsetIsWalking(false);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlastMovementTime.current = new Date().getTime();\n\t\t\tsetIsWalking(true);\n\t\t\tupdateDirection(newDirection);\n\t\t};\n\n\t\tconst handleKeyUp = () => {\n\t\t\tif (!shouldBindEvent) return;\n\t\t\t// keypress-move: keydown + keyup, i.e. D, D, D (not hold D)\n\t\t\t// Only stop the moving animation after the player goes idle\n\t\t\t// for some duration. This allows us to use keypress to move\n\t\t\t// and still have a move animation (instead of keydown).\n\t\t\t// This is needed because otherwise keypress-move wont trigger\n\t\t\t// animations.\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst delayedCurrentTime =\n\t\t\t\t\tnew Date().getTime() - ANIMATION_STOP_THROTTLE_DURATION;\n\t\t\t\tif (lastMovementTime.current >= delayedCurrentTime) return;\n\t\t\t\tsetIsWalking(false);\n\t\t\t\tonPlayerIsWalking?.(false, id);\n\t\t\t}, ANIMATION_STOP_THROTTLE_DURATION);\n\t\t};\n\n\t\t//\n\t\tif (shouldBindEvent) {\n\t\t\tdocument.addEventListener('keydown', handleKeyDown);\n\t\t\tdocument.addEventListener('keyup', handleKeyUp);\n\t\t}\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('keydown', handleKeyDown);\n\t\t\tdocument.removeEventListener('keyup', handleKeyUp);\n\t\t};\n\t}, [\n\t\tid,\n\t\tkeyboardConfig,\n\t\tonPlayerIsWalking,\n\t\tsetDirection,\n\t\tsetIsWalking,\n\t\tshouldBindEvent,\n\t]);\n};\n\nconst SpriteCharacter = ({\n\tid,\n\tcurrentOnlinePlayerId,\n\tname,\n\tcoordinates: { top, left },\n\tstyle,\n\tkeyboardConfig,\n\thighlight,\n\tsize,\n\tonPlayerIsWalking,\n\tisWalking: defaultIsWalking = false,\n\tdirection: defaultDirection = Direction.DOWN,\n\tisNPC = false,\n\t...rest\n}: Props) => {\n\t/** Direction being faced */\n\tconst [eventDirection, setEventDirection] = useState<Direction>(\n\t\tdefaultDirection\n\t);\n\tconst [eventIsWalking, setEventIsWalking] = useState<boolean>(\n\t\tdefaultIsWalking\n\t);\n\n\t// We only want to bind the event if it's:\n\t// - not online game\n\t// - online game and it's the current player\n\tconst shouldBindEvent =\n\t\t!isNPC && (!currentOnlinePlayerId || id === currentOnlinePlayerId);\n\n\tuseSpriteCharacterAction({\n\t\tid,\n\t\tcurrentOnlinePlayerId,\n\t\tkeyboardConfig,\n\t\tshouldBindEvent,\n\t\t// state setter\n\t\tonPlayerIsWalking,\n\t\t// setters\n\t\tsetDirection: setEventDirection,\n\t\tsetIsWalking: setEventIsWalking,\n\t});\n\n\tlet isWalking = defaultIsWalking;\n\tlet direction = defaultDirection;\n\n\tif (shouldBindEvent) {\n\t\tisWalking = eventIsWalking;\n\t\tdirection = eventDirection;\n\t}\n\n\treturn (\n\t\t<Wrapper\n\t\t\tid={id}\n\t\t\tstyle={{\n\t\t\t\t...style,\n\t\t\t\ttop,\n\t\t\t\tleft,\n\t\t\t}}\n\t\t\tclassName=\"character-wrapper\"\n\t\t\t{...rest}\n\t\t\t$size={size * 2}\n\t\t\t$name={name}\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName=\"character\"\n\t\t\t\tdata-facing={direction}\n\t\t\t\tdata-walking={isWalking.toString()}\n\t\t\t\tdata-highlight={highlight}\n\t\t\t>\n\t\t\t\t<div className=\"name\">{name}</div>\n\t\t\t\t<img\n\t\t\t\t\tclassName=\"shadow pixel-art\"\n\t\t\t\t\tsrc={spriteShadow}\n\t\t\t\t\talt=\"sprite skin\"\n\t\t\t\t/>\n\t\t\t\t<img\n\t\t\t\t\tclassName=\"spritesheet pixel-art\"\n\t\t\t\t\tsrc={spriteImage}\n\t\t\t\t\talt=\"sprite skin\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</Wrapper>\n\t);\n};\n\nexport type { Props as SpriteCharacterProps };\nexport default SpriteCharacter;\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAWUlEQVRYR+3XsQkAIAxEUe2cRXADx3cDwVksJYX970T41sE7Xqrk9Pjlx/nJAgoooIACCiiggAIKKKDAXwKt9k0uqblGIXMxgwVo+A2mJSyABYKWroHyx58Hv0cUIWfm8TkAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,UklGRuYBAABXRUJQVlA4TNkBAAAvf8AfEDegkI0kaB1Wc63vv4M4DQUByDA6SKk4ex2mqG0bqCCKrfwp7N5em/8A4P9XnTtjLpKQBLi1tbdt/gbqnTCAN/D5RCygH6yhQ4C1GfefQQG/fjA4FhH9Z9i2bZjkAbZdhsAn0N9Qh3Rps6Tr7enSZ9lZ1PV+6bPsLO4q4Fj1ORugiqJzAdemHQCwqMszM8vOoq4wzXNrso4rVOW6YeXnwAFDfg66i/MBl3QOm5+DDrAmX0BjNK5QAfYsOYVzJHCjcr1VjGTyTmZhrj2PUeUKvuZIeWc7iQ6TdK4URIcJSXIQyS75V0Q70f+F9g48tFcs4Nq6A4Vd69w7RGdRF4UBhmRnWZd1wlhZB3tQuabj0JFQXb4+n2pMKlfoeHgRzhW9cK7ZcyKVa2Kehcn3SWRURueqkpdcSWIEE0jv+ne4d0DeKxZw7a5jV/aO4IDByDlGSZe/VvYc1dUpu+RzNrlqa+ZxyrtOPESNyzs+5s9FtbRGUT2mUeUKdapHZe4wkzZ3oH+muYNvAMjO8q5tO7CMS7MHeJRxrSt3gHsgVzBlXYOUG3QYOtK4yLpTq8oVqMX4dFDlEh+OrVHlConjTLpcgrklARpJcDYpKl0xNco1wgRTwLUPTQA=\"","import LoadingIndicator from 'components/LoadingIndicator';\nimport NoAccess from 'components/NoAccess';\nimport {\n\tisEmpty,\n\tisLoaded,\n\tuseFirebase,\n\tuseFirebaseConnect,\n} from 'react-redux-firebase';\nimport { DataSnapshot, FirebaseUtils } from '../types';\n// eslint-disable-next-line import/no-unresolved\n// import { fromFirestore } from '../utils';\n// TODO: notification-provider\n// import useNotificationProvider from 'store/redux/hooks/useNotificationProvider';\n\nconst useFirebaseUtils = <RootSchema extends FirebaseUtils.UpdateableValue>(\n\tbaseRefPath: string\n) => {\n\t// const { notifyError } = useNotificationProvider();\n\tconst firebase = useFirebase();\n\tuseFirebaseConnect([baseRefPath]);\n\n\tconst getPath = (subPath?: FirebaseUtils.RefSubPath) => {\n\t\treturn `${baseRefPath}${subPath || ''}`;\n\t};\n\n\t/**\n\t * @example\n\t * ```ts\n\t * // Usage 1: Generate random id\n\t * const { key: newGameId } = (await create(newProps, subPaths)) as DataSnapshot;\n\t *\n\t * // Usage 2: Set your own id (fails if exists)\n\t * const customId = 'some-id';\n\t * await create(newProps, subPaths, undefined, customId);\n\t * ```\n\t */\n\tconst create = async <\n\t\tOverrideSchema extends FirebaseUtils.OverridableValue = void\n\t>(\n\t\t...[newProps, subPaths, cb, key]: FirebaseUtils.CreateProps<\n\t\t\tRootSchema,\n\t\t\tOverrideSchema\n\t\t>\n\t): FirebaseUtils.DataSnapshotPromise => {\n\t\ttry {\n\t\t\tlet dataSnapshot: DataSnapshot;\n\t\t\t// if provided with a key, first check if document exists\n\t\t\t// if it\n\t\t\tif (key) {\n\t\t\t\tdataSnapshot = await firebase.uniqueSet(getPath(subPaths), {\n\t\t\t\t\t[key]: newProps,\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tdataSnapshot = await firebase.push(getPath(subPaths), newProps);\n\t\t\t}\n\t\t\tcb?.onSuccess?.(dataSnapshot);\n\n\t\t\treturn dataSnapshot;\n\t\t} catch (err) {\n\t\t\tif (cb?.onError) cb.onError(err);\n\t\t\t// else notifyError(err);\n\t\t\treturn err;\n\t\t}\n\t};\n\n\tconst read = <OverrideSchema extends FirebaseUtils.OverridableValue = void>(\n\t\t...[state]: FirebaseUtils.ReadProps<RootSchema, OverrideSchema>\n\t) => {\n\t\tconst pending = !isLoaded(state) && <LoadingIndicator />;\n\t\tconst error = isEmpty(state) && <NoAccess />;\n\t\treturn {\n\t\t\tstate,\n\t\t\tpending,\n\t\t\terror,\n\t\t};\n\t};\n\n\tconst update = async <\n\t\tOverrideSchema extends FirebaseUtils.OverridableValue = void\n\t>(\n\t\t...[newProps, subPaths, cb]: FirebaseUtils.UpdateProps<\n\t\t\tRootSchema,\n\t\t\tOverrideSchema\n\t\t>\n\t): FirebaseUtils.DataSnapshotPromise => {\n\t\ttry {\n\t\t\tconst dataSnapshot = await firebase.update(\n\t\t\t\tgetPath(subPaths),\n\t\t\t\tnewProps\n\t\t\t);\n\t\t\tcb?.onSuccess?.(dataSnapshot);\n\t\t\treturn dataSnapshot;\n\t\t} catch (err) {\n\t\t\tif (cb?.onError) cb.onError(err);\n\t\t\t// else notifyError(err);\n\t\t\treturn err;\n\t\t}\n\t};\n\n\tconst push = async <\n\t\tOverrideSchema extends FirebaseUtils.OverridableValue = void\n\t>(\n\t\t...[newProps, subPaths, cb]: FirebaseUtils.PushProps<\n\t\t\tRootSchema,\n\t\t\tOverrideSchema\n\t\t>\n\t): FirebaseUtils.DataSnapshotPromise => {\n\t\ttry {\n\t\t\tconst dataSnapshot = await firebase.push(\n\t\t\t\tgetPath(subPaths),\n\t\t\t\tnewProps\n\t\t\t);\n\t\t\tcb?.onSuccess?.(dataSnapshot);\n\t\t\treturn dataSnapshot;\n\t\t} catch (err) {\n\t\t\tif (cb?.onError) cb.onError(err);\n\t\t\t// else notifyError(err);\n\t\t\treturn err;\n\t\t}\n\t};\n\n\tconst remove = async (\n\t\t...[subPaths, cb]: FirebaseUtils.RemoveProps\n\t): FirebaseUtils.DataSnapshotPromise => {\n\t\ttry {\n\t\t\tconst dataSnapshot = await firebase.remove(getPath(subPaths));\n\t\t\tcb?.onSuccess?.(dataSnapshot);\n\t\t\treturn dataSnapshot;\n\t\t} catch (err) {\n\t\t\tif (cb?.onError) cb.onError(err);\n\t\t\t// else notifyError(err);\n\t\t\treturn err;\n\t\t}\n\t};\n\n\treturn {\n\t\tcreate,\n\t\tread,\n\t\tupdate,\n\t\tpush,\n\t\tremove,\n\t};\n};\n\nexport default useFirebaseUtils;\n","import PageContainer from 'components/PageContainer';\nimport { H1 } from 'components/typography';\nimport theme from 'theme';\nimport styled from 'styled-components';\nimport Spacer from 'components/Spacer';\n\nconst H1Wrapper = styled(H1)`\n\tcolor: ${theme.palette.color.error};\n`;\n\ninterface Props {\n\tmessage?: string;\n}\n\nconst DEFAULT_ERROR_MESSAGE =\n\t\"Either the game is not found or you don't have access to it.\";\nconst NoAccess: React.FC<Props> = ({\n\tchildren,\n\tmessage = DEFAULT_ERROR_MESSAGE,\n}) => (\n\t<PageContainer fullHeight>\n\t\t<Spacer spacing=\"5\" />\n\t\t<H1Wrapper>{message}</H1Wrapper>\n\t\t<Spacer spacing=\"10\" />\n\t\t{children}\n\t</PageContainer>\n);\n\nexport default NoAccess;\n","import { createSelector, Selector } from 'reselect';\nimport { Store } from 'store/redux/types';\nimport { FirebaseState } from './types';\n\n// Direct selector to the userPreferences state\nconst selectFirebase: Selector<Store, FirebaseState> = state => {\n\treturn state.firebase;\n};\n\n// Other specific selectors\nconst makeSelectAuth = () => {\n\treturn createSelector(selectFirebase, ({ auth }) => auth);\n};\n\nconst makeSelectProfile = () => {\n\treturn createSelector(selectFirebase, ({ profile }) => profile);\n};\n\nconst makeSelectOnlineGame = (id: string) => {\n\treturn createSelector(\n\t\tselectFirebase,\n\t\t({ data: { online } }) => online?.[id]\n\t);\n};\n\n// Default selector\nconst makeSelectFirebase = () => {\n\treturn createSelector(selectFirebase, state => state);\n};\n\nexport {\n\tselectFirebase,\n\tmakeSelectAuth,\n\tmakeSelectProfile,\n\tmakeSelectOnlineGame,\n};\nexport default makeSelectFirebase;\n","import { isEmpty, isLoaded, useFirebaseConnect } from 'react-redux-firebase';\nimport { useSelector } from 'react-redux';\nimport { makeSelectOnlineGame } from 'store/redux/reducers/firebase/selectors';\nimport { generateDefaultGameState, generatePlayer } from 'utils/game';\nimport LoadingIndicator from 'components/LoadingIndicator';\nimport NoAccess from 'components/NoAccess';\nimport loadable from 'utils/loadable';\nimport { OnlineGame, PlayerConfig, PlayerId } from 'containers/Game/types';\nimport gameConfig from 'config';\nimport { PlayerCondition } from 'enums';\nimport useFirebaseUtils from './useFirebaseUtils';\nimport useOnlineGameActions from './useOnlineGameActions';\n// TODO: notification-provider\n// import useNotificationProvider from 'store/redux/hooks/useNotificationProvider';\n\nconst LazyJoin = loadable(() => import(`routes/pages/Join`));\n\nconst defaultGameState = generateDefaultGameState();\n\nconst useWatchOnlineGame = (id: string) => {\n\t// const { notifyError } = useNotificationProvider();\n\tconst refKey = `online/${id}`;\n\tuseFirebaseConnect(refKey);\n\tconst { update, remove } = useFirebaseUtils<OnlineGame>(refKey);\n\tconst { removeOnlineGame } = useOnlineGameActions();\n\n\tconst onlineGameFromFirebase = useSelector(makeSelectOnlineGame(id));\n\n\tconst pending = !isLoaded(onlineGameFromFirebase) && <LoadingIndicator />;\n\tconst error = isEmpty(onlineGameFromFirebase) && (\n\t\t<NoAccess>\n\t\t\t<LazyJoin noWrapper />\n\t\t</NoAccess>\n\t);\n\n\tconst game = onlineGameFromFirebase;\n\n\tconst onPlayerJoin = (playerId: PlayerId, isNPC = false) => {\n\t\t// set player as active\n\t\tupdate<OnlineGame['gamePlayers']>(\n\t\t\t{\n\t\t\t\t[playerId]: PlayerCondition.Alive,\n\t\t\t},\n\t\t\t'/gamePlayers'\n\t\t);\n\n\t\tconst playerConfig = generatePlayer(\n\t\t\tplayerId,\n\t\t\tgame.gameState.config,\n\t\t\t(!isNPC && gameConfig.keyboardConfig) || null\n\t\t);\n\n\t\t// put him in the game state\n\t\tupdate<PlayerConfig>(playerConfig, `/gameState/players/${playerId}`);\n\t};\n\n\tconst onStartGame = () => {\n\t\tupdate({\n\t\t\tstarted: true,\n\t\t});\n\t};\n\n\tconst onEndGame = () => {\n\t\tupdate({\n\t\t\tstarted: false,\n\t\t});\n\t};\n\n\tconst onPlayerExit = (playerId: PlayerId) => {\n\t\t// remove as active player\n\t\tremove(`/gamePlayers/${playerId}`);\n\t\t// remove him from the game state\n\t\tremove(`/gameState/players/${playerId}`);\n\n\t\tif (game.gamePlayers) {\n\t\t\tconst playerLength = Object.keys(game.gamePlayers).length;\n\t\t\t// 1 <= because the state won't be updated just yet\n\t\t\tif (playerLength <= 1) {\n\t\t\t\tremoveOnlineGame(id);\n\t\t\t\t// 2 <= because the state won't be updated just yet\n\t\t\t\t// ??!!: Is this necessary? Change this when restart is added\n\t\t\t} else if (playerLength <= 2) {\n\t\t\t\tonEndGame();\n\t\t\t}\n\t\t}\n\t};\n\n\tconst onPlayerDeath = (playerId: PlayerId) => {\n\t\tupdate<OnlineGame['gamePlayers']>(\n\t\t\t{\n\t\t\t\t[playerId]: PlayerCondition.Dead,\n\t\t\t},\n\t\t\t'/gamePlayers'\n\t\t);\n\t};\n\n\tconst _game: OnlineGame = {\n\t\tgameId: id,\n\t\tgameState: {\n\t\t\tplayers: game?.gameState?.players || defaultGameState.players,\n\t\t\tgameMap: game?.gameState?.gameMap || defaultGameState.gameMap,\n\t\t\tbombs: game?.gameState?.bombs || defaultGameState.bombs,\n\t\t\tpowerUps: game?.gameState?.powerUps || defaultGameState.powerUps,\n\t\t\tis3D: game?.gameState?.is3D || defaultGameState.is3D,\n\t\t\tisSideView:\n\t\t\t\tgame?.gameState?.isSideView || defaultGameState.isSideView,\n\t\t\tanimationCounter:\n\t\t\t\tgame?.gameState?.animationCounter ||\n\t\t\t\tdefaultGameState.animationCounter,\n\t\t\tconfig: game?.gameState?.config || defaultGameState.config,\n\t\t},\n\t\tgamePlayers: game?.gamePlayers || {},\n\t\tstarted: game?.started || false,\n\t};\n\n\treturn {\n\t\tgame: _game,\n\t\tpending,\n\t\terror,\n\t\tisReady: !pending && !error,\n\t\tonPlayerJoin,\n\t\tonPlayerExit,\n\t\tonStartGame,\n\t\tonPlayerDeath,\n\t};\n};\n\nexport default useWatchOnlineGame;\n","import {\n\tuniqueNamesGenerator,\n\tConfig,\n\tcolors,\n\tanimals,\n} from 'unique-names-generator';\n\nconst customConfig: Config = {\n\tdictionaries: [colors, animals],\n\tseparator: '-',\n};\n\nconst getRandomName = () => uniqueNamesGenerator(customConfig);\n\nexport default getRandomName;\n","import { useFirebaseConnect } from 'react-redux-firebase';\nimport { GameState } from 'store/redux/reducers/game/types';\nimport { OnlineGame, OnlineGameId } from 'containers/Game/types';\nimport getRandomName from 'utils/random-name-generator';\nimport useFirebaseUtils from './useFirebaseUtils';\n\nconst useOnlineGameActions = () => {\n\tconst refKey = `online`;\n\tuseFirebaseConnect(refKey);\n\tconst { create, update, remove } = useFirebaseUtils<OnlineGame>(refKey);\n\n\tconst createOnlineGame = async (gameState: GameState) => {\n\t\tconst randomName = getRandomName();\n\t\t// create the game\n\t\tawait create(\n\t\t\t{\n\t\t\t\tgameState,\n\t\t\t\tstarted: false,\n\t\t\t},\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t\trandomName\n\t\t);\n\n\t\t// TODO: error checking..\n\t\t// set its id\n\t\tawait update(\n\t\t\t{\n\t\t\t\tgameId: randomName as OnlineGameId,\n\t\t\t},\n\t\t\t`/${randomName}`\n\t\t);\n\t\treturn randomName;\n\t};\n\n\tconst removeOnlineGame = async (gameId: OnlineGameId) => {\n\t\tremove(`/${gameId}`);\n\t};\n\n\treturn {\n\t\tcreateOnlineGame,\n\t\tremoveOnlineGame,\n\t};\n};\n\nexport default useOnlineGameActions;\n","import { useCallback, useEffect, useRef } from 'react';\n\ntype Callback = () => void;\n\n/**\n * setInterval hook.\n *\n * @see https://overreacted.io/making-setinterval-declarative-with-react-hooks/#just-show-me-the-code\n *\n * @param callback Method to call in each interval.\n * @param delay Delay for interval (in milliseconds).\n * @param shouldStop Some condition to trigger a stop on the interval.\n *\n * @returns stopper for the interval\n */\nconst useInterval = (\n\tcallback: Callback,\n\tdelay: number,\n\tshouldStop: boolean\n) => {\n\tconst savedCallback = useRef<Callback>();\n\tconst id = useRef<NodeJS.Timeout>();\n\n\t// Remember the latest callback.\n\tuseEffect(() => {\n\t\tsavedCallback.current = callback;\n\t}, [callback]);\n\n\tconst clearLastInterval = useCallback(() => {\n\t\tif (!id.current) return;\n\t\tclearInterval(id.current as NodeJS.Timeout);\n\t}, []);\n\n\tconst triggerCb = useCallback(() => {\n\t\tsavedCallback.current?.();\n\t}, []);\n\n\t// Set up the interval.\n\tuseEffect(() => {\n\t\tif (!shouldStop) id.current = setInterval(triggerCb, delay);\n\t\treturn () => clearLastInterval();\n\t}, [delay, shouldStop, clearLastInterval, triggerCb]);\n\n\t// Stop the interval if the stop is requested\n\tuseEffect(() => {\n\t\tif (shouldStop) clearLastInterval();\n\t}, [shouldStop, clearLastInterval]);\n\n\treturn clearLastInterval;\n};\n\nexport default useInterval;\n","import { useEffect, useRef } from 'react';\n\nconst usePrevious = (value: any) => {\n\tconst ref = useRef();\n\n\tuseEffect(() => {\n\t\tref.current = value;\n\t}, [value]);\n\n\treturn ref.current;\n};\n\nexport default usePrevious;\n","import {\n\tGameMap,\n\tNPCActionFn,\n\tPlayers,\n\tSquare,\n\tSquareCoordinates,\n} from 'containers/Game/types';\nimport { Direction, Player, PowerUp, Tile } from 'enums';\nimport { Bombs, GameConfig } from 'store/redux/reducers/game/types';\nimport {\n\tgetExplosionResults,\n\tgetPoweredUpValue,\n\tgetSquareCoordinatesFromSquareOrTopLeftCoordinates,\n\tisSquareOutOfBoundaries,\n} from './game';\nimport { getRandomInt } from './math';\n\n// allow debugging in prod\n// @ts-ignore\nwindow.NPC_DEBUG = false;\nconst log = (value: any, label = '') => {\n\t// @ts-ignore\n\tif (!window.NPC_DEBUG) return;\n\tconsole.log(...[label, value].filter(Boolean));\n};\n\ntype NpcStore = {\n\tid: number;\n\tparentNodes: MovementNode[];\n\tlastBombTime: number;\n\tdropBomb: () => void;\n\tgameMap: GameMap;\n\tplayers: Players;\n\tbombs: Bombs;\n\tpowerUpConfig: GameConfig['powerUps'];\n\tsizes: GameConfig['sizes'];\n\tbombDuration: GameConfig['duration']['bomb'];\n} | null;\nlet Store: NpcStore;\n\ntype Score = number | undefined;\n\nenum NPCScore {\n\tIsDanger = -10000,\n\tIsNonBreakingTile = -100,\n\tIsNonAdjacentNonBreakingTile = -5,\n\tIsStuck = 0,\n\tIsEmptyTile = 2,\n\tIsBreakingTile = 3,\n\tIsPlayer = 4,\n\t/** If the current and the next spots are fire, we need to get out */\n\tIsPossibleFireExit = 1,\n\tIsPowerUp = 1000,\n}\n\ntype MovementNode = {\n\tscore: Score;\n\tparentId: number | null;\n\thasChildren: boolean;\n\tdirection: Direction;\n\tlevel: number;\n};\n\ntype MovementNodeWithKey = {\n\t[key: number]: MovementNode;\n};\n\nconst isDifferentSquare = (\n\tnewCoordinates: SquareCoordinates,\n\toldCoordinates: SquareCoordinates\n) => {\n\tconst { ySquare: newYSquare, xSquare: newXSquare } = newCoordinates;\n\tconst { ySquare: oldYSquare, xSquare: oldXSquare } = oldCoordinates;\n\n\treturn newYSquare !== oldYSquare || newXSquare !== oldXSquare;\n};\n\nconst isSquareAPlayer = (square: Square) => {\n\treturn Object.values<Square>(Player).includes(square);\n};\n\nconst isSquareAPossibleFire = (currentSquareCoordinates: SquareCoordinates) => {\n\tconst bombs = Object.values(Store!.bombs);\n\tif (!bombs.length) return false;\n\n\tconst _fireCoordinates: Array<SquareCoordinates> = [];\n\n\tbombs.forEach(({ playerId, top, left }) => {\n\t\tconst { players } = Store!;\n\t\tconst { coordinatesToSetOnFire } = getExplosionResults(\n\t\t\tStore!.gameMap,\n\t\t\t{ top, left },\n\t\t\tplayers[playerId]?.state\n\t\t\t\t? getPoweredUpValue(\n\t\t\t\t\t\tplayers[playerId]!.state,\n\t\t\t\t\t\tPowerUp.BombSize,\n\t\t\t\t\t\tStore!.powerUpConfig\n\t\t\t\t  )\n\t\t\t\t: Store!.powerUpConfig.defaults[PowerUp.BombSize],\n\t\t\tStore!.sizes\n\t\t);\n\t\tObject.values(coordinatesToSetOnFire)\n\t\t\t.flat()\n\t\t\t.forEach(squareCoordinates => {\n\t\t\t\t_fireCoordinates.push(squareCoordinates);\n\t\t\t});\n\t});\n\n\treturn (\n\t\t_fireCoordinates.findIndex(fireSquareCoordinates => {\n\t\t\treturn !isDifferentSquare(\n\t\t\t\tfireSquareCoordinates,\n\t\t\t\tcurrentSquareCoordinates\n\t\t\t);\n\t\t}) >= 0\n\t);\n};\n\nconst isAdjacent = (\n\t{ ySquare: newYSquare, xSquare: newXSquare }: SquareCoordinates,\n\t{ ySquare: oldYSquare, xSquare: oldXSquare }: SquareCoordinates\n) => {\n\treturn (\n\t\t// Directly top or below. If left coordinate is the same and it is +-1 top coordinate\n\t\t// Place a bomb\n\t\t(newXSquare === oldXSquare &&\n\t\t\t(newYSquare === oldYSquare + 1 || newYSquare === oldYSquare - 1)) ||\n\t\t// directly left or right. Same idea as above but for +1 left coordinate\n\t\t(newYSquare === oldYSquare &&\n\t\t\t(newXSquare === oldXSquare + 1 || newXSquare === oldXSquare - 1))\n\t);\n};\n\nconst dropBombAndRunOrScoreTarget = (\n\tnewCoordinates: SquareCoordinates,\n\toldCoordinates: SquareCoordinates,\n\ttargetScore: Score,\n\trunScore?: -100\n) => {\n\t// TODO: is this necessary? it's already the nextSquare\n\tif (isAdjacent(newCoordinates, oldCoordinates)) {\n\t\t// TODO: move this up to usePlayerEvents\n\t\tconst currentTime = new Date().getTime();\n\t\tif (\n\t\t\tStore!.lastBombTime <=\n\t\t\tcurrentTime -\n\t\t\t\tObject.values(Store!.bombDuration).reduce(\n\t\t\t\t\t(acc, duration) => acc + duration,\n\t\t\t\t\t0\n\t\t\t\t) *\n\t\t\t\t\t1000\n\t\t) {\n\t\t\tStore!.dropBomb();\n\t\t\tStore!.lastBombTime = currentTime;\n\t\t}\n\t\treturn runScore;\n\t}\n\tif (isDifferentSquare(newCoordinates, oldCoordinates)) {\n\t\treturn targetScore;\n\t}\n\n\treturn null;\n};\n\nconst generateScore = (\n\tnewCoordinates: SquareCoordinates,\n\toldCoordinates: SquareCoordinates,\n\tlevel: number\n): number | undefined => {\n\tconst { ySquare: newYSquare, xSquare: newXSquare } = newCoordinates;\n\n\tif (isSquareOutOfBoundaries(newCoordinates, Store!.sizes.map)) {\n\t\treturn undefined;\n\t}\n\n\tconst newSquare = Store!.gameMap[newYSquare][newXSquare];\n\t// TODO: Please comment\n\tif (isSquareAPossibleFire(newCoordinates)) {\n\t\tif (isSquareAPossibleFire(oldCoordinates)) {\n\t\t\treturn NPCScore.IsPossibleFireExit;\n\t\t}\n\t\treturn NPCScore.IsDanger;\n\t}\n\tif (Object.values(PowerUp).includes(newSquare as PowerUp)) {\n\t\treturn NPCScore.IsPowerUp * level;\n\t}\n\tif (!isDifferentSquare(newCoordinates, oldCoordinates)) {\n\t\treturn NPCScore.IsStuck;\n\t}\n\tif (newSquare === Tile.Empty) {\n\t\treturn NPCScore.IsEmptyTile;\n\t}\n\tif (isSquareAPlayer(newSquare)) {\n\t\tconst score = dropBombAndRunOrScoreTarget(\n\t\t\tnewCoordinates,\n\t\t\toldCoordinates,\n\t\t\tNPCScore.IsPlayer\n\t\t);\n\t\tif (score !== null) return score;\n\t}\n\tif (newSquare === Tile.Breaking) {\n\t\tif (isSquareAPossibleFire(oldCoordinates)) {\n\t\t\treturn NPCScore.IsDanger;\n\t\t}\n\t\tconst score = dropBombAndRunOrScoreTarget(\n\t\t\tnewCoordinates,\n\t\t\toldCoordinates,\n\t\t\tNPCScore.IsBreakingTile\n\t\t);\n\t\tif (score !== null) return score;\n\t}\n\tif (newSquare === Tile.NonBreaking) {\n\t\t// TODO: is this necessary? it's already the nextSquare\n\t\tif (isAdjacent(newCoordinates, oldCoordinates)) {\n\t\t\treturn NPCScore.IsNonBreakingTile;\n\t\t}\n\t\treturn NPCScore.IsNonAdjacentNonBreakingTile;\n\t}\n\n\treturn NPCScore.IsStuck;\n};\n\nconst generateMovementTree = (\n\tnewCoordinates: SquareCoordinates,\n\toldCoordinates: SquareCoordinates,\n\tlevel: number = 1,\n\tparentId: number | null = null\n) => {\n\tconst { ySquare: newYSquare, xSquare: newXSquare } = newCoordinates;\n\tlet playerMovementTree: MovementNodeWithKey = {};\n\n\tObject.values(Direction).forEach(direction => {\n\t\tlet _newYSquare = newYSquare;\n\t\tlet _newXSquare = newXSquare;\n\n\t\tStore!.id++;\n\n\t\tswitch (direction) {\n\t\t\tcase Direction.LEFT:\n\t\t\t\t_newXSquare--;\n\t\t\t\tbreak;\n\t\t\tcase Direction.UP:\n\t\t\t\t_newYSquare--;\n\t\t\t\tbreak;\n\t\t\tcase Direction.RIGHT:\n\t\t\t\t_newXSquare++;\n\t\t\t\tbreak;\n\t\t\tcase Direction.DOWN:\n\t\t\t\t_newYSquare++;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\tconst score = generateScore(\n\t\t\t{ ySquare: _newYSquare, xSquare: _newXSquare },\n\t\t\toldCoordinates,\n\t\t\tlevel\n\t\t);\n\n\t\tplayerMovementTree[Store!.id] = {\n\t\t\tscore,\n\t\t\thasChildren: level > 0 && score !== undefined,\n\t\t\tparentId,\n\t\t\tdirection,\n\t\t\tlevel,\n\t\t};\n\t\tif (level > 0 && !!score) {\n\t\t\tplayerMovementTree = {\n\t\t\t\t...playerMovementTree,\n\t\t\t\t...generateMovementTree(\n\t\t\t\t\t{ ySquare: _newYSquare, xSquare: _newXSquare },\n\t\t\t\t\toldCoordinates,\n\t\t\t\t\tlevel - 1,\n\t\t\t\t\tStore!.id\n\t\t\t\t),\n\t\t\t};\n\t\t}\n\t});\n\n\treturn playerMovementTree!;\n};\n\nconst findNodeWithHighestScore = (movementNodes: MovementNode[]) => {\n\treturn movementNodes.reduce((acc, current) => {\n\t\tlet retVal = current;\n\t\tif (current.score === undefined) {\n\t\t\tretVal = acc;\n\t\t}\n\t\tif (acc.score! > current.score!) {\n\t\t\tretVal = acc;\n\t\t}\n\t\tif (acc.score! < current.score!) {\n\t\t\tretVal = current;\n\t\t}\n\t\tif (acc.score === current.score) {\n\t\t\tconst randomInt = getRandomInt(2);\n\t\t\tretVal = randomInt === 0 ? current : acc;\n\t\t}\n\n\t\treturn retVal;\n\t});\n};\n\nconst groupMovementNodesByParentId = (movementNodes: MovementNode[]) => {\n\tconst movementNodesGroupedById: { [key: number]: MovementNode[] } = {};\n\n\tmovementNodes.forEach(movementNode => {\n\t\tconst movementNodeParentId = movementNode.parentId!;\n\t\tif (movementNodesGroupedById[movementNodeParentId]) {\n\t\t\tmovementNodesGroupedById[movementNodeParentId].push(movementNode);\n\t\t} else {\n\t\t\tmovementNodesGroupedById[movementNodeParentId] = [movementNode];\n\t\t}\n\t});\n\treturn movementNodesGroupedById;\n};\n\nconst getTotalScoreOfAllNodes = (\n\tmovementTree: MovementNodeWithKey,\n\tparentId: number | undefined | null = undefined\n) => {\n\tlet validMovementNodes: MovementNode[];\n\n\tif (parentId !== null) {\n\t\tif (parentId === undefined) {\n\t\t\tvalidMovementNodes = Object.values(movementTree).filter(\n\t\t\t\tmovementNode => !movementNode.hasChildren\n\t\t\t);\n\t\t} else {\n\t\t\tvalidMovementNodes = Object.values(movementTree).filter(\n\t\t\t\tmovementNode =>\n\t\t\t\t\tmovementNode.parentId === movementTree[parentId!].parentId\n\t\t\t);\n\t\t}\n\n\t\tconst movementNodesGroupedByParentId = groupMovementNodesByParentId(\n\t\t\tvalidMovementNodes!\n\t\t);\n\n\t\tObject.entries(movementNodesGroupedByParentId).forEach(\n\t\t\t([groupParentId, movementNodes]) => {\n\t\t\t\tconst _groupParentId =\n\t\t\t\t\tgroupParentId === 'null' ? null : Number(groupParentId);\n\n\t\t\t\tconst nodeWithHighestScore = findNodeWithHighestScore(\n\t\t\t\t\tmovementNodes!\n\t\t\t\t);\n\n\t\t\t\tif (!_groupParentId) {\n\t\t\t\t\tif (\n\t\t\t\t\t\t!Store!.parentNodes.some(\n\t\t\t\t\t\t\tparentNode =>\n\t\t\t\t\t\t\t\tparentNode.direction ===\n\t\t\t\t\t\t\t\tnodeWithHighestScore.direction\n\t\t\t\t\t\t)\n\t\t\t\t\t) {\n\t\t\t\t\t\tStore!.parentNodes.push(nodeWithHighestScore);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\t\tmovementTree[_groupParentId].score =\n\t\t\t\t\t\tmovementTree[_groupParentId].score! +\n\t\t\t\t\t\t(nodeWithHighestScore.score!\n\t\t\t\t\t\t\t? nodeWithHighestScore.score\n\t\t\t\t\t\t\t: 0);\n\t\t\t\t\tgetTotalScoreOfAllNodes(movementTree, _groupParentId);\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n};\n\nconst findBestMove = (\n\tcurrentCoordinates: SquareCoordinates\n): MovementNode | null => {\n\tStore!.id = 0;\n\tStore!.parentNodes = [];\n\n\tconst movementTree = generateMovementTree(\n\t\tcurrentCoordinates,\n\t\tcurrentCoordinates,\n\t\tundefined\n\t);\n\tlog(currentCoordinates, 'currentCoordinates');\n\tlog(movementTree, 'originalMoves');\n\tgetTotalScoreOfAllNodes(movementTree);\n\tlog(movementTree, 'scoredMoves');\n\n\treturn findNodeWithHighestScore(Store!.parentNodes);\n};\n\nconst npcAction: NPCActionFn = ({\n\tplayerId,\n\tplayers,\n\tgameMap,\n\tbombs,\n\ttriggerMove,\n\tdropBomb,\n\tref,\n\tpowerUpConfig,\n\tsizes,\n\tbombDuration,\n}) => {\n\tconst currentPlayer = players[playerId];\n\tStore = {\n\t\tid: 0,\n\t\tparentNodes: [],\n\t\tlastBombTime: 0,\n\t\tdropBomb: () => dropBomb(playerId),\n\t\tgameMap,\n\t\tbombs,\n\t\tplayers,\n\t\tpowerUpConfig,\n\t\tsizes,\n\t\tbombDuration,\n\t};\n\n\tif (!currentPlayer) return;\n\n\t// eslint-disable-next-line max-len\n\tconst currentSquareCoordinates = getSquareCoordinatesFromSquareOrTopLeftCoordinates(\n\t\tcurrentPlayer.coordinates,\n\t\tsizes.movement\n\t);\n\n\tconst bestMovementNode = findBestMove(currentSquareCoordinates);\n\tlog(bestMovementNode, 'bestMovementNode');\n\n\tif ((bestMovementNode?.score || 0) > 0) {\n\t\ttriggerMove({ playerId, direction: bestMovementNode!.direction, ref });\n\t}\n};\n\nexport { npcAction };\n","import {\n\tGameApi,\n\tKeyboardConfig,\n\tKeyboardEventCode,\n\tKeyMap,\n\tNonNullablePlayerRef,\n\tOnDropBomb,\n\tPlayerId,\n\tPlayers,\n} from 'containers/Game/types';\nimport { GameType, PowerUp } from 'enums';\nimport { useEffect, useMemo, useRef } from 'react';\nimport {\n\tgetMoveDirectionFromKeyMap,\n\tgetPoweredUpValue,\n\tisPlayerDead,\n\tmapAllPossibleKeyboardKeysForAction,\n} from 'utils/game';\nimport { npcAction } from 'utils/npc';\nimport useInterval from 'hooks/useInterval';\nimport usePrevious from 'hooks/usePrevious';\nimport { CODE_SPACE } from 'keycode-js';\nimport { GameConfig, OnTriggerMove, TriggerMove } from '../reducers/game/types';\n\ntype HandleActionsFn = (playerId: PlayerId) => void;\ntype KeyDownAction = (playerId: PlayerId, keys: KeyboardConfig) => void;\n\ntype KeyAction = (keyEventCode: KeyboardEventCode) => void;\n\nconst usePlayerRefs = () => {\n\tconst playerRefs = useRef<{ [key in PlayerId]?: HTMLElement | null }>({\n\t\tP1: document.getElementById('P1'),\n\t\tP2: document.getElementById('P2'),\n\t\tP3: document.getElementById('P3'),\n\t\tP4: document.getElementById('P4'),\n\t});\n\n\tconst recalculate = () => {\n\t\tObject.keys(playerRefs.current).forEach(playerId => {\n\t\t\tplayerRefs.current[playerId as PlayerId] = document.getElementById(\n\t\t\t\tplayerId\n\t\t\t);\n\t\t});\n\t};\n\n\treturn { playerRefs, recalculate };\n};\n\nconst useTimeOutRef = () => {\n\tconst timeOutRef = useRef<Record<PlayerId, number>>({\n\t\tP1: new Date().getTime(),\n\t\tP2: new Date().getTime(),\n\t\tP3: new Date().getTime(),\n\t\tP4: new Date().getTime(),\n\t});\n\n\treturn timeOutRef;\n};\n\nconst useCanMove = (\n\tplayers: Players,\n\tpowerUpConfig: GameConfig['powerUps']\n) => {\n\tconst timeOutRef = useTimeOutRef();\n\tconst canMove = (playerId: PlayerId) => {\n\t\tconst npc = players[playerId];\n\t\tif (!npc) return false;\n\t\tconst { state: npcState } = npc;\n\t\tconst newTime = new Date().getTime();\n\t\tconst movementSpeed = getPoweredUpValue(\n\t\t\tnpcState,\n\t\t\tPowerUp.MovementSpeed,\n\t\t\tpowerUpConfig\n\t\t);\n\t\tif (newTime - timeOutRef.current[playerId]! > movementSpeed) {\n\t\t\ttimeOutRef.current[playerId] = newTime;\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t};\n\n\treturn canMove;\n};\n\nconst useEvents = ({\n\ttriggerMove,\n\tplayers,\n\ttimeOutRef,\n\tkeyMap,\n\tis3D,\n\tpowerUpConfig,\n}: {\n\ttriggerMove: OnTriggerMove;\n\tplayers: Players;\n\tkeyMap: React.MutableRefObject<KeyMap>;\n\ttimeOutRef: React.MutableRefObject<Record<PlayerId, number>>;\n\tis3D: boolean;\n\tpowerUpConfig: GameConfig['powerUps'];\n}) => {\n\tconst { playerRefs, recalculate } = usePlayerRefs();\n\tconst previousIs3D = usePrevious(is3D);\n\n\tuseEffect(() => {\n\t\tif (previousIs3D === is3D) return;\n\t\trecalculate();\n\t}, [is3D, previousIs3D, recalculate]);\n\n\tconst canMove = useCanMove(players, powerUpConfig);\n\n\tconst move: KeyDownAction = (playerId, playerKeyboardConfig) => {\n\t\tconst directions = getMoveDirectionFromKeyMap(\n\t\t\tkeyMap,\n\t\t\tplayerKeyboardConfig\n\t\t);\n\t\tif (!directions.length) return;\n\n\t\tdirections.forEach(direction => {\n\t\t\ttriggerMove({\n\t\t\t\tplayerId,\n\t\t\t\tdirection,\n\t\t\t\tref: playerRefs.current[playerId] as NonNullablePlayerRef,\n\t\t\t});\n\t\t});\n\t};\n\n\tconst handleActions = (playerId: PlayerId) => {\n\t\tif (!keyMap.current) return;\n\t\tif (!timeOutRef.current) return;\n\t\t// don't do anything if no key is being pressed\n\t\tif (!Object.values(keyMap.current).filter(Boolean).length) return;\n\n\t\tconst { keyboardConfig } = players[playerId]!;\n\t\tif (!keyboardConfig || !Object.keys(keyboardConfig).length) return;\n\n\t\tconst ref = playerRefs.current[playerId];\n\t\tif (!ref) {\n\t\t\tplayerRefs.current[playerId] = document.getElementById(playerId);\n\t\t}\n\n\t\tif (ref && canMove(playerId)) move(playerId, keyboardConfig);\n\t};\n\n\treturn { move, handleActions };\n};\n\nconst useKeyboardEvent = ({\n\tonKeyDown,\n\tonKeyUp,\n}: {\n\tonKeyDown?: KeyAction;\n\tonKeyUp?: KeyAction;\n} = {}) => {\n\tconst keyMap = useRef<KeyMap>({});\n\n\tuseEffect(() => {\n\t\tconst registerKeys = (e: KeyboardEvent, isKeyDown: boolean) => {\n\t\t\t/** @see https://stackoverflow.com/questions/5203407/how-to-detect-if-multiple-keys-are-pressed-at-once-using-javascript#answer-12444641 */\n\t\t\tkeyMap.current[e.code as KeyboardEventCode] = isKeyDown;\n\t\t};\n\n\t\tconst handleKeyEvent = (e: KeyboardEvent) => {\n\t\t\tif (!keyMap.current) return;\n\n\t\t\tconst isKeyDown = e.type === 'keydown';\n\t\t\tif (e.code === CODE_SPACE) e.preventDefault();\n\t\t\tregisterKeys(e, isKeyDown);\n\t\t\tif (isKeyDown) onKeyDown?.(e.code as KeyboardEventCode);\n\t\t\telse onKeyUp?.(e.code as KeyboardEventCode);\n\t\t};\n\n\t\twindow.addEventListener('keyup', handleKeyEvent);\n\t\twindow.addEventListener('keydown', handleKeyEvent);\n\n\t\treturn () => {\n\t\t\twindow.removeEventListener('keyup', handleKeyEvent);\n\t\t\twindow.removeEventListener('keydown', handleKeyEvent);\n\t\t};\n\t}, [onKeyDown, onKeyUp]);\n\n\treturn keyMap;\n};\n\nconst usePlayerActionSpeed = (\n\tplayers: Players,\n\tplayerId: PlayerId,\n\tpowerUpConfig: GameConfig['powerUps']\n) => {\n\tconst movementSpeed = useMemo(() => {\n\t\tconst playerState = players[playerId]?.state;\n\t\t// if there is no NPC, lets not call this often\n\t\tif (!playerState) return null;\n\t\treturn getPoweredUpValue(\n\t\t\tplayerState,\n\t\t\tPowerUp.MovementSpeed,\n\t\t\tpowerUpConfig\n\t\t);\n\t}, [playerId, players, powerUpConfig]);\n\n\treturn movementSpeed;\n};\n\nconst canPlayerTakeAction = (\n\tplayers: Players,\n\tplayerId: PlayerId,\n\tpowerUpConfig: GameConfig['powerUps']\n) => {\n\tconst player = players[playerId];\n\t// player doesn't exist\n\tif (!player) return false;\n\t// player is dead\n\tif (isPlayerDead(player.state, powerUpConfig)) return false;\n\n\treturn true;\n};\n\nconst usePlayerInterval = (\n\tplayers: Players,\n\tplayerId: PlayerId,\n\tpowerUpConfig: GameConfig['powerUps'],\n\tcb: HandleActionsFn\n) => {\n\tconst playerActionSpeedOrNull = usePlayerActionSpeed(\n\t\tplayers,\n\t\tplayerId,\n\t\tpowerUpConfig\n\t);\n\n\tuseInterval(\n\t\t() => {\n\t\t\tif (!canPlayerTakeAction(players, playerId, powerUpConfig)) return;\n\t\t\tcb(playerId);\n\t\t},\n\t\tplayerActionSpeedOrNull || Number.MAX_SAFE_INTEGER,\n\t\t!playerActionSpeedOrNull\n\t);\n};\n\nconst handleBombForPlayers = (\n\tplayers: Players,\n\tdropBomb: OnDropBomb,\n\tpowerUpConfig: GameConfig['powerUps']\n) => (keyEventCode: KeyboardEventCode) => {\n\t(Object.keys(players) as Array<PlayerId>).forEach(playerId => {\n\t\tif (canPlayerTakeAction(players, playerId, powerUpConfig)) {\n\t\t\tconst { keyboardConfig } = players[playerId]!;\n\t\t\tif (keyboardConfig) {\n\t\t\t\t// let isKeyPressed = false;\n\t\t\t\tconst bombKeys = mapAllPossibleKeyboardKeysForAction(\n\t\t\t\t\tkeyboardConfig,\n\t\t\t\t\t'DropBomb'\n\t\t\t\t);\n\t\t\t\tif (bombKeys.includes(keyEventCode)) {\n\t\t\t\t\tdropBomb(playerId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n};\n\nconst IntervalWrapper = ({\n\tplayerId,\n\tplayers,\n\tpowerUpConfig,\n\tcb,\n}: {\n\tplayerId: PlayerId;\n\tplayers: Players;\n\tpowerUpConfig: GameConfig['powerUps'];\n\tcb: HandleActionsFn;\n}) => {\n\tusePlayerInterval(players, playerId, powerUpConfig, cb);\n\treturn null;\n};\n\nconst usePlayerEvents = ({\n\tstate,\n\tprovider,\n\ttype: gameType,\n\tplayerId,\n}: GameApi) => {\n\tconst { dropBomb, triggerMove } = provider;\n\tconst {\n\t\tgameMap,\n\t\tbombs,\n\t\tplayers,\n\t\tis3D,\n\t\tconfig: {\n\t\t\tpowerUps: powerUpConfig,\n\t\t\tsizes,\n\t\t\tduration: { bomb: bombDuration },\n\t\t},\n\t} = state;\n\n\tconst { playerRefs } = usePlayerRefs();\n\n\tconst _players = useMemo<Players>(() => {\n\t\treturn gameType === GameType.Local\n\t\t\t? players\n\t\t\t: { [playerId!]: players[playerId!] };\n\t\t// none of the deps will affect this\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [players]);\n\t// }, [gameType, playerId, players]);\n\n\tconst keyMap = useKeyboardEvent({\n\t\tonKeyDown: handleBombForPlayers(_players, dropBomb, powerUpConfig),\n\t});\n\tconst timeOutRef = useTimeOutRef();\n\tconst { handleActions } = useEvents({\n\t\ttriggerMove,\n\t\tplayers: _players,\n\t\ttimeOutRef,\n\t\tkeyMap,\n\t\tis3D,\n\t\tpowerUpConfig,\n\t});\n\n\tconst canMove = useCanMove(players, powerUpConfig);\n\n\tconst handleNpcActions = (pId: PlayerId) => {\n\t\tconst ref = playerRefs.current[pId];\n\n\t\tif (!ref) {\n\t\t\tplayerRefs.current[pId] = document.getElementById(pId);\n\t\t}\n\n\t\tnpcAction({\n\t\t\tplayerId: pId,\n\t\t\tdropBomb,\n\t\t\tgameMap,\n\t\t\tbombs,\n\t\t\tplayers: _players,\n\t\t\ttriggerMove: (props: TriggerMove) => {\n\t\t\t\tif (canMove(pId)) triggerMove(props);\n\t\t\t},\n\t\t\tref: playerRefs.current[pId] as NonNullablePlayerRef,\n\t\t\tpowerUpConfig,\n\t\t\tsizes,\n\t\t\tbombDuration,\n\t\t});\n\t};\n\n\t// URGENT: Since this triggers a move event, if the\n\t// player is on the same explosion fire, he dies\n\t// multiple times\n\t// TODO: In the next update, start these intervals\n\t// when the keys are pressed and not continuously\n\treturn Object.keys(_players).map(pId => {\n\t\t// TODO: online game can also have NPCs, have a check for that\n\t\tconst { isNPC } = _players[pId as PlayerId]!;\n\t\treturn (\n\t\t\t<IntervalWrapper\n\t\t\t\tkey={pId}\n\t\t\t\tplayerId={pId as PlayerId}\n\t\t\t\tplayers={_players}\n\t\t\t\tpowerUpConfig={powerUpConfig}\n\t\t\t\tcb={isNPC ? handleNpcActions : handleActions}\n\t\t\t/>\n\t\t);\n\t});\n};\n\nexport { useKeyboardEvent };\nexport default usePlayerEvents;\n","import { forwardRef, memo } from 'react';\nimport styled from 'styled-components';\nimport theme from 'theme';\n\ninterface Props extends React.ButtonHTMLAttributes<HTMLButtonElement> {\n\tvariant?: ColorVariants;\n\tsize?: BaseSize;\n}\n\nconst Container = styled.button<StyledProps<Props, 'variant' | 'size'>>`\n\tbackground-color: ${({ $variant }) =>\n\t\ttheme.palette.color[$variant as ColorVariants]};\n\t/* IGNORE SIZE FOR NOW */\n\tborder-radius: ${theme.shape.borderRadius};\n\tpadding: ${theme.shape.padding};\n\tcursor: pointer;\n\ttransition: background-color ${theme.transition.hover};\n\n\t&:hover {\n\t\tbackground-color: ${({ $variant }) =>\n\t\t\ttheme.palette.color[`${$variant}-lighter` as ColorVariants]};\n\t}\n`;\n\n// TODO: Remove this component as we got mui now, use TooltipButton\nconst Button = forwardRef<HTMLButtonElement, Props>(\n\t({ variant = 'default', size = 'medium', children, ...rest }, ref) => {\n\t\treturn (\n\t\t\t<Container $variant={variant} $size={size} ref={ref} {...rest}>\n\t\t\t\t{children}\n\t\t\t</Container>\n\t\t);\n\t}\n);\n\nexport type { Props as ButtonProps };\nexport default memo(Button);\n","import styled from 'styled-components';\nimport Spacer from 'components/Spacer';\nimport { PickedGameState } from './types';\n\nconst SettingsAndMap = styled.div`\n\tdisplay: flex;\n\tjustify-content: center;\n\tflex-wrap: wrap;\n\n\t& > :first-child {\n\t\tmargin-right: 50px;\n\t\twidth: 15%;\n\t\t@media only screen and (max-width: 600px) {\n\t\t\twidth: 100%;\n\t\t\tmargin: 50px auto;\n\t\t\torder: 2;\n\t\t\t& button {\n\t\t\t\twidth: 80% !important;\n\t\t\t}\n\t\t}\n\t}\n`;\n\nconst CenteredDiv = styled.div<{ $is3D: boolean }>`\n\ttext-align: center;\n\t${({ $is3D }) => ($is3D && 'perspective: 1000') || ''}\n`;\n\ninterface Props extends PickedGameState<'is3D'> {}\n\nconst GameContainer: React.FC<Props> = ({ children, is3D }) => {\n\treturn (\n\t\t<CenteredDiv $is3D={is3D}>\n\t\t\t<Spacer spacing=\"2\" />\n\t\t\t<SettingsAndMap>{children}</SettingsAndMap>\n\t\t</CenteredDiv>\n\t);\n};\n\nexport type { Props as GameContainerProps };\nexport default GameContainer;\n","import Button from 'components/Button';\nimport { GamePayload } from 'store/redux/reducers/game/types';\nimport { wrapPreventFocusLock } from 'utils';\n\ninterface Props extends Partial<React.ComponentProps<typeof Button>> {\n\tactive?: boolean;\n\tonClick: ReactOnClick<GamePayload>;\n}\n\nconst GameButton = ({ active = false, onClick, children, ...rest }: Props) => {\n\treturn (\n\t\t<Button\n\t\t\tstyle={{ width: '100%', wordWrap: 'break-word', marginBottom: 10 }}\n\t\t\tvariant={active ? 'success' : 'warning'}\n\t\t\tonClick={wrapPreventFocusLock(onClick)}\n\t\t\t{...rest}\n\t\t>\n\t\t\t{children}\n\t\t</Button>\n\t);\n};\n\nexport default GameButton;\n","import { memo, useMemo } from 'react';\nimport GameButton from './GameButton';\nimport { GameApi } from './types';\n\ninterface Props extends GameApi {}\n\nconst GameSettings = ({ state, provider }: Props) => {\n\tconst {\n\t\tgenerateNewCollisionCoordinates,\n\t\ttogglePerspective,\n\t\ttoggleDimension,\n\t} = provider;\n\n\tconst { is3D, isSideView } = state;\n\n\tconst buttons = useMemo(\n\t\t() =>\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tlabel: 'New Tiles / Map',\n\t\t\t\t\tonClick: generateNewCollisionCoordinates,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Toggle 3D (Experimental)',\n\t\t\t\t\tonClick: toggleDimension,\n\t\t\t\t\tactive: is3D,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Toggle Side View',\n\t\t\t\t\tonClick: togglePerspective,\n\t\t\t\t\tactive: isSideView,\n\t\t\t\t\tdisabled: !is3D,\n\t\t\t\t},\n\t\t\t].map(({ label, ...rest }) => (\n\t\t\t\t<GameButton key={label} {...rest}>\n\t\t\t\t\t{label}\n\t\t\t\t</GameButton>\n\t\t\t)),\n\t\t[\n\t\t\tgenerateNewCollisionCoordinates,\n\t\t\tis3D,\n\t\t\tisSideView,\n\t\t\ttoggleDimension,\n\t\t\ttogglePerspective,\n\t\t]\n\t);\n\n\treturn <div>{buttons}</div>;\n};\n\nexport type { Props as GameSettingsProps };\nexport default memo(GameSettings);\n","import { useEffect, useRef } from 'react';\n\nconst useIsUnmounted = () => {\n\tconst isMounted = useRef(true);\n\n\tuseEffect(() => {\n\t\treturn () => {\n\t\t\tisMounted.current = false;\n\t\t};\n\t}, []);\n\n\treturn isMounted;\n};\n\nexport default useIsUnmounted;\n","import './Cube.scss';\nimport styled from 'styled-components';\nimport { TileProps } from '../types';\n\nconst CuboidSide = styled.div``;\n\nconst Cuboid = styled.div<StyledProps<TileProps, 'size'>>`\n\t${({ $size }) => `\n\t\t--tile-size: ${$size};\n\t`}\n\theight: calc(var(--tile-size) * 1px);\n\twidth: calc(var(--tile-size) * 1px);\n\ttransform-style: preserve-3d;\n\tposition: absolute;\n\ttransform-origin: center center;\n\ttransition: 300ms;\n\n\ttransform: scale(1, 1) translateZ(calc(var(--tile-size) / 2 * -1px));\n\n\t& > ${CuboidSide} {\n\t\tborder: 1px solid var(--primary-background);\n\n\t\theight: calc(var(--tile-size) * 1px);\n\t\twidth: calc(var(--tile-size) * 1px);\n\t\t/* transform-origin: 50% 50%; */\n\t\ttop: 50%;\n\t\tleft: 50%;\n\t\tposition: absolute;\n\n\t\t/** @see https://codepen.io/jh3y/pen/BaKqQLJ */\n\t\t&:nth-of-type(1) {\n\t\t\ttransform: translate(-50%, -50%) rotateX(-90deg)\n\t\t\t\ttranslateZ(calc((var(--tile-size) / 2) * 1px));\n\t\t}\n\t\t&:nth-of-type(2) {\n\t\t\ttransform: translate(-50%, -50%) rotateX(-90deg) rotateY(180deg)\n\t\t\t\ttranslateZ(calc((var(--tile-size) / 2) * 1px));\n\t\t}\n\t\t&:nth-of-type(3) {\n\t\t\ttransform: translate(-50%, -50%) rotateX(-90deg) rotateY(90deg)\n\t\t\t\ttranslateZ(calc((var(--tile-size) / 2) * 1px));\n\t\t}\n\t\t&:nth-of-type(4) {\n\t\t\ttransform: translate(-50%, -50%) rotateX(-90deg) rotateY(-90deg)\n\t\t\t\ttranslateZ(calc((var(--tile-size) / 2) * 1px));\n\t\t}\n\t\t&:nth-of-type(5) {\n\t\t\tbackground-color: var(--secondary-background);\n\t\t\ttransform: translate(-50%, -50%)\n\t\t\t\ttranslateZ(calc((var(--tile-size) / 2) * 1px));\n\t\t}\n\t\t&:nth-of-type(6) {\n\t\t\ttransform: translate(-50%, -50%)\n\t\t\t\ttranslateZ(calc((var(--tile-size) / 2) * -1px)) rotateX(180deg);\n\t\t}\n\t}\n\n\t&.bouncy-block- {\n\t\t&no-animation {\n\t\t\ttransform: translateZ(calc(var(--tile-size) / 2 * 1px));\n\t\t\t& > ${CuboidSide} {\n\t\t\t\tbackground-color: var(--secondary-color);\n\t\t\t}\n\t\t}\n\n\t\t&0 {\n\t\t\ttransform: translateZ(calc(var(--tile-size) / 2 * 1px))\n\t\t\t\trotateX(0deg) rotateY(0deg) rotateZ(0deg);\n\t\t}\n\t}\n`;\n\nconst Cube = ({\n\tsize,\n\ttop,\n\tleft,\n\tanimate = false,\n\tvariant,\n\tcolor: backgroundColor,\n\tcollisionIndex,\n\tstyle,\n\tclassName,\n\t...rest\n}: TileProps) => {\n\tconst _className = `cuboid bouncy-block-${\n\t\t(!animate && 'no-animation') || collisionIndex || 0\n\t} ${variant}${(className && ` ${className}`) || ''}`;\n\n\treturn (\n\t\t<Cuboid\n\t\t\tclassName={_className}\n\t\t\tstyle={{ ...style, top, left, width: size, height: size }}\n\t\t\t$size={size}\n\t\t\t{...rest}\n\t\t>\n\t\t\t{Array(6)\n\t\t\t\t.fill(0)\n\t\t\t\t.map((_, ind) => (\n\t\t\t\t\t<CuboidSide\n\t\t\t\t\t\tkey={ind}\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t...(backgroundColor && { backgroundColor }),\n\t\t\t\t\t\t\twidth: size,\n\t\t\t\t\t\t\theight: size,\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t</Cuboid>\n\t);\n};\n\nexport default Cube;\n","import { ExplosionState, Explosive } from 'enums';\nimport useIsUnmounted from 'hooks/useIsUnmounted';\nimport { useEffect, useState } from 'react';\nimport {\n\tBomb as BombType,\n\tBombFn,\n\tBombId,\n\tGameConfigRanges,\n} from 'store/redux/reducers/game/types';\nimport styled, { keyframes } from 'styled-components';\nimport theme from 'theme';\nimport { sleep } from 'utils';\nimport { PlayerId } from '../types';\nimport Cube from './Cube';\n\nconst getTransform = (deg: number, is3D: boolean) => {\n\treturn `${\n\t\tis3D\n\t\t\t? `transform: translateZ(calc(var(--tile-size) / 2 * 2px)) rotateX(${deg}deg) rotateY(${deg}deg)`\n\t\t\t: `transform: rotate(${deg}deg)`\n\t};`;\n};\n\nconst incrementalSpeedRotationKeyframes = (is3D = false) => keyframes`\n\t0% { ${getTransform(0, is3D)} }\n\t\n\t/* 40% -> 100% */\n\t${Array(7)\n\t\t.fill(0)\n\t\t.map(\n\t\t\t(_, ind) =>\n\t\t\t\t/* start at 40% */\n\t\t\t\t`${(ind + 4) * 10}% { ${getTransform(\n\t\t\t\t\t/* gradually increase the rotation degree multiplier */\n\t\t\t\t\t(ind + 1) *\n\t\t\t\t\t\t((is3D && ((ind < 6 && 90) || 100)) ||\n\t\t\t\t\t\t\t(ind < 4 && 90) ||\n\t\t\t\t\t\t\t(ind < 6 && 270) ||\n\t\t\t\t\t\t\t360),\n\t\t\t\t\tis3D\n\t\t\t\t)} }`\n\t\t)\n\t\t.join('\\n')}\n`;\n\nconst FiringBomb = styled.div`\n\tanimation: ${incrementalSpeedRotationKeyframes()} linear forwards;\n`;\n\nconst FiringCubeBomb = styled(Cube)`\n\t/* ${({ size }) => `\n\t\t--tile-size: ${size};\n\t`} */\n\tanimation: ${incrementalSpeedRotationKeyframes(true)} linear forwards;\n`;\ninterface Props extends BombType {\n\t// skin: Skin;\n\tcolor: string;\n\ttileSize: GameConfigRanges.SquareSize;\n\tfiringDuration: number;\n\texplodingDuration: number;\n\ttriggerExplosion: BombFn;\n\tonExplosionComplete: BombFn;\n\tis3D: boolean;\n\t/** needed to not trigger the bomb explosion multiple times */\n\tcurrentOnlinePlayerId?: PlayerId;\n}\n\nconst Bomb = ({\n\tcolor: backgroundColor,\n\tfiringDuration,\n\texplodingDuration,\n\t// explosionSize,\n\tplayerId,\n\tcurrentOnlinePlayerId,\n\ttileSize,\n\tid,\n\ttop,\n\tleft,\n\ttriggerExplosion,\n\tonExplosionComplete,\n\tis3D,\n}: Props) => {\n\tconst [explosionState, setExplosionState] = useState<ExplosionState>(\n\t\tExplosionState.Firing\n\t);\n\n\tconst isMounted = useIsUnmounted();\n\n\t// We only want to bind the event if it's:\n\t// - not online game\n\t// - online game and it's the current player\n\tconst shouldBindEvent =\n\t\t!currentOnlinePlayerId || playerId === currentOnlinePlayerId;\n\n\tuseEffect(() => {\n\t\tconst kaboom = async () => {\n\t\t\tawait sleep(firingDuration * 1000);\n\t\t\tif (!isMounted.current) return;\n\t\t\ttriggerExplosion(id, async (bombIds: Set<BombId>) => {\n\t\t\t\tif (!isMounted.current) return;\n\t\t\t\t// update animation\n\t\t\t\tsetExplosionState(ExplosionState.Exploding);\n\t\t\t\tawait sleep(explodingDuration * 1000);\n\n\t\t\t\tif (!isMounted.current) return;\n\t\t\t\t// complete explosion for this bomb\n\t\t\t\tonExplosionComplete(id);\n\t\t\t\t// then complete the explosion for all the other bombs\n\t\t\t\t// that got caught in the fire complete their explosion\n\t\t\t\t// as the trigger was already handled in the reducer\n\t\t\t\tbombIds.forEach(bId => {\n\t\t\t\t\tonExplosionComplete(bId);\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\t\tif (shouldBindEvent) kaboom();\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, []);\n\n\tconst bombSize = tileSize / 2;\n\tconst bombPadding = bombSize / 2;\n\n\tconst bombStyleProps: React.CSSProperties = {\n\t\tposition: 'absolute',\n\t\tbackgroundColor,\n\t\twidth: bombSize,\n\t\theight: bombSize,\n\t\ttop: top + bombPadding,\n\t\tleft: left + bombPadding,\n\t\tanimationDuration: `${firingDuration}s`,\n\t};\n\n\treturn (\n\t\t(explosionState === ExplosionState.Firing &&\n\t\t\t((!is3D && <FiringBomb style={bombStyleProps} />) || (\n\t\t\t\t<FiringCubeBomb\n\t\t\t\t\tsize={bombSize}\n\t\t\t\t\ttop={Number(bombStyleProps.top)}\n\t\t\t\t\tleft={Number(bombStyleProps.left)}\n\t\t\t\t\tanimate={false}\n\t\t\t\t\tvariant={Explosive.Bomb}\n\t\t\t\t\tcolor={theme.palette.color.error}\n\t\t\t\t\tcollisionIndex={1}\n\t\t\t\t\tstyle={bombStyleProps}\n\t\t\t\t/>\n\t\t\t))) ||\n\t\tnull\n\t);\n};\n\nexport default Bomb;\n","import Cube from 'containers/Game/components/Cube';\nimport { Direction, Player } from 'enums';\nimport { GameProvider } from 'store/redux/hooks/useGameProvider';\nimport { GameConfigRanges } from 'store/redux/reducers/game/types';\nimport theme from 'theme';\nimport { CUBE_BASE_TRANSFORM } from 'utils/game';\nimport { KeyboardConfig, PlayerId, TopLeftCoordinates } from '../types';\n// import CircleCharacter from './CircleCharacter';\nimport SpriteCharacter from './SpriteCharacter';\n\ninterface Props extends React.HTMLAttributes<HTMLDivElement> {\n\tid: PlayerId;\n\tcurrentOnlinePlayerId?: PlayerId;\n\tname: string;\n\tsize: GameConfigRanges.SquareSize;\n\ttileSize: GameConfigRanges.SquareSize;\n\tcoordinates: TopLeftCoordinates;\n\tkeyboardConfig?: KeyboardConfig;\n\tis3D: boolean;\n\thighlight?: boolean;\n\t// mainly for sprite\n\t// skin: Skin;\n\tonPlayerIsWalking?: GameProvider['updatePlayerIsWalking'];\n\tisWalking?: boolean;\n\tdirection?: Direction;\n\tisNPC?: boolean;\n}\n\nconst Character = ({\n\t/* skin */\n\tid,\n\tcurrentOnlinePlayerId,\n\tname,\n\tsize,\n\ttileSize,\n\tcoordinates: { top, left },\n\tkeyboardConfig,\n\tis3D,\n\thighlight = false,\n\t...rest\n}: Props) => {\n\tconst padding = (tileSize - size) / 2;\n\n\tconst _top = padding + top;\n\tconst _left = padding + left;\n\n\treturn (\n\t\t(is3D && (\n\t\t\t<Cube\n\t\t\t\tid={id}\n\t\t\t\tsize={size}\n\t\t\t\ttop={_top}\n\t\t\t\tleft={_left}\n\t\t\t\tanimate\n\t\t\t\tcolor={theme.palette.color.success}\n\t\t\t\tstyle={{\n\t\t\t\t\ttransform: CUBE_BASE_TRANSFORM,\n\t\t\t\t\t// top,\n\t\t\t\t\t// left,\n\t\t\t\t}}\n\t\t\t\tvariant={Player[id]}\n\t\t\t\t{...rest}\n\t\t\t/>\n\t\t)) || (\n\t\t\t<SpriteCharacter\n\t\t\t\tid={id}\n\t\t\t\tcurrentOnlinePlayerId={currentOnlinePlayerId}\n\t\t\t\t// name={`${name}${id}`}\n\t\t\t\tname={id}\n\t\t\t\tcoordinates={{\n\t\t\t\t\ttop: _top,\n\t\t\t\t\tleft: _left,\n\t\t\t\t}}\n\t\t\t\tkeyboardConfig={keyboardConfig}\n\t\t\t\thighlight={highlight}\n\t\t\t\tsize={size}\n\t\t\t\t{...rest}\n\t\t\t/>\n\t\t)\n\t);\n};\n\nexport type { Props as CharacterProps };\nexport default Character;\n","import theme from 'theme';\nimport { PowerUp } from 'enums';\nimport {\n\tgetPoweredUpValue,\n\tisPlayerDead,\n\tisPlayerSteppingOnFire,\n} from 'utils/game';\nimport useWatchOnlineGame from 'store/firebase/hooks/useWatchOnlineGame';\nimport Bomb from './components/Bomb';\nimport Character from './components/Character';\nimport { GameApi, OnlineGameId, PlayerConfig, PlayerId } from './types';\nimport DeadCharacter from './components/DeadCharacter';\n\ntype PlayerEntry = Array<[PlayerId, PlayerConfig]>;\n\ninterface Props extends GameApi {\n\tgameId?: OnlineGameId;\n}\n\nconst GameContent = ({\n\tstate,\n\tprovider,\n\tplayerId: currentOnlinePlayerId,\n\tgameId,\n}: Props) => {\n\tconst {\n\t\ttriggerExplosion,\n\t\tonExplosionComplete,\n\t\tupdatePlayerIsWalking,\n\t} = provider;\n\tconst { gameMap, players, bombs, is3D, config } = state;\n\n\tconst { onPlayerDeath } = useWatchOnlineGame(gameId || '');\n\n\treturn (\n\t\t<>\n\t\t\t{(Object.entries(players) as PlayerEntry).map(\n\t\t\t\t([playerId, playerConfig]) => {\n\t\t\t\t\tconst {\n\t\t\t\t\t\tcoordinates,\n\t\t\t\t\t\tstate: playerState,\n\t\t\t\t\t\t...rest\n\t\t\t\t\t} = playerConfig;\n\n\t\t\t\t\tconst isAlive = !isPlayerDead(playerState, config.powerUps);\n\t\t\t\t\tconst isSteppingOnFire = isPlayerSteppingOnFire(\n\t\t\t\t\t\tgameMap,\n\t\t\t\t\t\tcoordinates,\n\t\t\t\t\t\tconfig.sizes.movement\n\t\t\t\t\t);\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t(isAlive && (\n\t\t\t\t\t\t\t<Character\n\t\t\t\t\t\t\t\tcurrentOnlinePlayerId={currentOnlinePlayerId}\n\t\t\t\t\t\t\t\tkey={playerId}\n\t\t\t\t\t\t\t\tname=\"Bomber\"\n\t\t\t\t\t\t\t\tsize={config.sizes.character}\n\t\t\t\t\t\t\t\ttileSize={config.sizes.tile}\n\t\t\t\t\t\t\t\tcoordinates={coordinates!}\n\t\t\t\t\t\t\t\tis3D={is3D}\n\t\t\t\t\t\t\t\thighlight={isSteppingOnFire}\n\t\t\t\t\t\t\t\tonPlayerIsWalking={updatePlayerIsWalking}\n\t\t\t\t\t\t\t\t{...rest}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)) || (\n\t\t\t\t\t\t\t<DeadCharacter\n\t\t\t\t\t\t\t\tid={playerId}\n\t\t\t\t\t\t\t\tname={playerId}\n\t\t\t\t\t\t\t\tkey={playerId}\n\t\t\t\t\t\t\t\tcoordinates={coordinates!}\n\t\t\t\t\t\t\t\tsize={config.sizes.character}\n\t\t\t\t\t\t\t\texplodingDuration={\n\t\t\t\t\t\t\t\t\tconfig.duration.bomb.exploding\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tonDeathAnimationComplete={onPlayerDeath}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t)}\n\t\t\t{Object.values(bombs).map(({ id, playerId, ...bombProps }) => {\n\t\t\t\tconst playerState = players[playerId]?.state;\n\t\t\t\tif (!playerState) return null;\n\n\t\t\t\tconst explosionSize = getPoweredUpValue(\n\t\t\t\t\tplayerState,\n\t\t\t\t\tPowerUp.BombSize,\n\t\t\t\t\tconfig.powerUps\n\t\t\t\t);\n\n\t\t\t\treturn (\n\t\t\t\t\t<Bomb\n\t\t\t\t\t\tkey={id}\n\t\t\t\t\t\tid={id}\n\t\t\t\t\t\tplayerId={playerId}\n\t\t\t\t\t\tcurrentOnlinePlayerId={currentOnlinePlayerId}\n\t\t\t\t\t\t{...bombProps}\n\t\t\t\t\t\tcolor={theme.palette.color.error}\n\t\t\t\t\t\ttileSize={config.sizes.tile}\n\t\t\t\t\t\texplosionSize={explosionSize}\n\t\t\t\t\t\tfiringDuration={config.duration.bomb.firing}\n\t\t\t\t\t\texplodingDuration={config.duration.bomb.exploding}\n\t\t\t\t\t\ttriggerExplosion={triggerExplosion}\n\t\t\t\t\t\tonExplosionComplete={onExplosionComplete}\n\t\t\t\t\t\tis3D={is3D}\n\t\t\t\t\t/>\n\t\t\t\t);\n\t\t\t})}\n\t\t</>\n\t);\n};\n\nexport type { Props as GameContentProps };\nexport default GameContent;\n","import { bounceAnimation } from 'animations';\nimport { Explosive } from 'enums';\nimport { memo } from 'react';\nimport styled, { css, keyframes } from 'styled-components';\nimport theme from 'theme';\nimport { Fire, TileProps } from '../types';\n\ntype WrapperProps = StyledProps<\n\tTileProps,\n\t| 'size'\n\t| 'top'\n\t| 'left'\n\t| 'animate'\n\t| 'color'\n\t| 'collisionIndex'\n\t| 'fireSquare'\n>;\n\nconst fireAnimation = (fireSquare: Fire) => {\n\tlet x = 0;\n\tlet y = 0;\n\tlet rotateFrom = '';\n\tlet rotateTo = '';\n\tlet borderRadiusFrom = '';\n\tlet borderRadiusTo = '';\n\n\tif (fireSquare === Explosive.FireHorizontal) {\n\t\tx = 1;\n\t} else if (fireSquare === Explosive.FireVertical) {\n\t\ty = 1;\n\t} else {\n\t\tx = 0.5;\n\t\ty = 0.5;\n\t\trotateFrom = ' rotate(90deg)';\n\t\trotateTo = ' rotate(360deg)';\n\t\tborderRadiusFrom = 'border-radius: 50%;';\n\t\tborderRadiusTo = 'border-radius: 0%;';\n\t}\n\n\treturn keyframes`\n\t\t// cool effect\n\t\t/* 0% { border: 16px solid ${theme.palette.background.primary}; transform: scale(${x}, ${y})${rotateFrom}; ${borderRadiusFrom} } */\n\t\t0% { background-color: ${theme.palette.background.primary}; transform: scale(${x}, ${y})${rotateFrom}; ${borderRadiusFrom} }\n\t\t20% { background-color: ${theme.palette.color.error}; }\n\t\t40% { background-color: ${theme.palette.color.info}; }\n\t\t50% { ${borderRadiusTo} }\n\t\t60% { background-color: ${theme.palette.color.error}; }\n\t\t80% { background-color: ${theme.palette.color.info}; }\n\t\t100% { background-color: ${theme.palette.color.error}; transform: scale(1)${rotateTo};  }\n\t`;\n};\n\nconst Wrapper = styled.div.attrs<WrapperProps>(\n\t({ $size, $top, $left, $color }) => ({\n\t\tstyle: {\n\t\t\twidth: $size,\n\t\t\theight: $size,\n\t\t\ttop: $top,\n\t\t\tleft: $left,\n\t\t\t...($color && { backgroundColor: $color }),\n\t\t},\n\t})\n)<WrapperProps>`\n\tposition: absolute;\n\t/* background-color: ${theme.palette.background.secondary}; */\n\tborder: 1px solid ${theme.palette.background.primary};\n\t${({ $color, $collisionIndex, $animate, $fireSquare }) => {\n\t\treturn (\n\t\t\t($fireSquare &&\n\t\t\t\tcss`\n\t\t\t\t\tborder: none;\n\t\t\t\t\tanimation: ${fireAnimation($fireSquare)}\n\t\t\t\t\t\tcalc(var(--firing-duration) / 2)\n\t\t\t\t\t\tvar(--ease-in-out-quint) forwards;\n\t\t\t\t`) ||\n\t\t\t($animate &&\n\t\t\t\t$color &&\n\t\t\t\tcss`\n\t\t\t\t\ttransform: scale(0, 0);\n\t\t\t\t\tz-index: 9999;\n\t\t\t\t\tanimation: ${bounceAnimation()}\n\t\t\t\t\t\tvar(--block-animation-duration) ease\n\t\t\t\t\t\tcalc(\n\t\t\t\t\t\t\t${$collisionIndex as number} *\n\t\t\t\t\t\t\t\tvar(--incremental-animation-delay)\n\t\t\t\t\t\t)\n\t\t\t\t\t\tforwards;\n\t\t\t\t`) ||\n\t\t\t''\n\t\t);\n\t}}\n`;\n\nconst Tile = ({\n\tsize,\n\ttop,\n\tleft,\n\tcolor,\n\tcollisionIndex,\n\tanimate = false,\n\tfireSquare,\n}: TileProps) => {\n\treturn (\n\t\t<Wrapper\n\t\t\t$size={size}\n\t\t\t$top={top}\n\t\t\t$left={left}\n\t\t\t$animate={animate}\n\t\t\t$color={color}\n\t\t\t$collisionIndex={collisionIndex}\n\t\t\t$fireSquare={fireSquare}\n\t\t/>\n\t);\n};\n\nexport default memo(Tile);\n","import { PowerUp as PowerUpEnum } from 'enums';\nimport TileIcon from '../TileIcon';\nimport icons from './icons';\n\ninterface Props {\n\tvariant: PowerUpEnum;\n\tsize: number;\n\ttop: number;\n\tleft: number;\n}\n\nconst PowerUp = ({ variant, top, left, size }: Props) => {\n\tconst { icon: Icon, color } = icons[variant];\n\treturn (\n\t\t<TileIcon $top={top} $left={left} $size={size}>\n\t\t\t<Icon color={color} />\n\t\t</TileIcon>\n\t);\n};\n\nexport default PowerUp;\n","import usePrevious from 'hooks/usePrevious';\nimport styled from 'styled-components';\nimport theme from 'theme';\nimport { Explosive, Tile as TileEnum } from 'enums';\nimport { isPowerUp } from 'utils/game';\nimport { useEffect } from 'react';\nimport { GameConfig } from 'store/redux/reducers/game/types';\nimport Cube from './Cube';\nimport Tile from './Tile';\nimport { GameMap, Square, TileProps } from '../types';\nimport PowerUp from './PowerUp';\n\ninterface Props {\n\tsizes: GameConfig['sizes'];\n\tgameMap: GameMap;\n\tis3D: boolean;\n\tisTopView: boolean;\n\tanimationCounter: number;\n}\n\nconst Wrapper = styled.div<\n\tStyledProps<Props, 'is3D' | 'isTopView'> & {\n\t\t$mapSize: GameConfig['sizes']['map'];\n\t\t$tileSize: GameConfig['sizes']['tile'];\n\t}\n>`\n\t${({ $mapSize, $tileSize }) => `\n\t\twidth: calc(${$tileSize}px * ${$mapSize});\n\t\theight: calc(${$tileSize}px * ${$mapSize});\n\t`}\n\tborder-radius: ${theme.shape.borderRadius};\n\tbackground-color: ${theme.palette.background.secondary};\n\tposition: relative;\n\tbox-shadow: 0 10px 20px rgba(0, 0, 0, 0.5), 0 6px 6px rgba(0, 0, 0, 0.6);\n\ttransition: transform var(--block-animation-duration);\n\n\t${({ $is3D, $isTopView }) => {\n\t\tlet style = '';\n\t\tif ($is3D) {\n\t\t\tstyle += 'transform-style: preserve-3d;';\n\t\t\tif (!$isTopView) {\n\t\t\t\tstyle += `\\ntransform: rotateX(-24deg) rotateY(-24deg) rotateX(90deg);`;\n\t\t\t}\n\t\t}\n\t\treturn style;\n\t}}\n`;\n\nconst Map: React.FC<Props> = ({\n\tsizes: { map: mapSize, tile: tileSize },\n\tgameMap,\n\tis3D,\n\tisTopView,\n\tanimationCounter,\n\tchildren,\n}) => {\n\t// we only need to animate when new collision is set using the button\n\t// need to prevent explosion diff from re-animating tiles\n\tconst previousAnimationCounter = usePrevious(animationCounter);\n\tlet shouldAnimate = animationCounter !== previousAnimationCounter;\n\n\tuseEffect(() => {\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t\tshouldAnimate = true;\n\t}, []);\n\n\tlet collisionIndex = 1;\n\treturn (\n\t\t<Wrapper\n\t\t\t$mapSize={mapSize}\n\t\t\t$tileSize={tileSize}\n\t\t\t$is3D={is3D}\n\t\t\t$isTopView={isTopView}\n\t\t>\n\t\t\t{Object.keys(gameMap).map((outer, outerInd) => {\n\t\t\t\treturn Object.values(gameMap[outer]).map(\n\t\t\t\t\t(square: Square, innerInd) => {\n\t\t\t\t\t\tconst hasCollision =\n\t\t\t\t\t\t\tsquare === TileEnum.NonBreaking ||\n\t\t\t\t\t\t\tsquare === TileEnum.Breaking;\n\n\t\t\t\t\t\tconst key = `${outerInd}_${innerInd}`;\n\t\t\t\t\t\tconst squareSize = tileSize;\n\t\t\t\t\t\tconst top = outerInd * tileSize;\n\t\t\t\t\t\tconst left = innerInd * tileSize;\n\n\t\t\t\t\t\t// if it's a PowerUp\n\t\t\t\t\t\tif (isPowerUp(square)) {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<PowerUp\n\t\t\t\t\t\t\t\t\tkey={key}\n\t\t\t\t\t\t\t\t\tsize={squareSize}\n\t\t\t\t\t\t\t\t\tvariant={square as ValuesOf<typeof PowerUp>}\n\t\t\t\t\t\t\t\t\ttop={top}\n\t\t\t\t\t\t\t\t\tleft={left}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet fireSquare;\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tsquare === Explosive.FireCore ||\n\t\t\t\t\t\t\tsquare === Explosive.FireHorizontal ||\n\t\t\t\t\t\t\tsquare === Explosive.FireVertical\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tfireSquare = square;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// TODO: Get this key properly\n\t\t\t\t\t\tconst props: TileProps & { key: string } = {\n\t\t\t\t\t\t\tkey,\n\t\t\t\t\t\t\tsize: squareSize,\n\t\t\t\t\t\t\ttop,\n\t\t\t\t\t\t\tleft,\n\t\t\t\t\t\t\tanimate: shouldAnimate,\n\t\t\t\t\t\t\tvariant: square,\n\t\t\t\t\t\t\tfireSquare,\n\t\t\t\t\t\t\t...(hasCollision && {\n\t\t\t\t\t\t\t\tcolor:\n\t\t\t\t\t\t\t\t\ttheme.palette.color[\n\t\t\t\t\t\t\t\t\t\tsquare === TileEnum.NonBreaking\n\t\t\t\t\t\t\t\t\t\t\t? 'secondary'\n\t\t\t\t\t\t\t\t\t\t\t: 'primary'\n\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\tcollisionIndex: collisionIndex++,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t(is3D &&\n\t\t\t\t\t\t\t\t((hasCollision && <Cube {...props} />) || (\n\t\t\t\t\t\t\t\t\t<Tile {...props} />\n\t\t\t\t\t\t\t\t))) || <Tile {...props} />\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t})}\n\t\t\t{children}\n\t\t</Wrapper>\n\t);\n};\n\nexport default Map;\n","import { GameConfig } from 'store/redux/reducers/game/types';\nimport Map from './components/Map';\nimport { PickedGameState } from './types';\n\ninterface Props\n\textends PickedGameState<\n\t\t'gameMap' | 'is3D' | 'isSideView' | 'animationCounter'\n\t> {\n\tsizes: GameConfig['sizes'];\n}\n\nconst GameMap: React.FC<Props> = ({\n\tsizes,\n\tchildren,\n\tgameMap,\n\tis3D,\n\tisSideView,\n\tanimationCounter,\n}) => {\n\treturn (\n\t\t<Map\n\t\t\tsizes={sizes}\n\t\t\tgameMap={gameMap}\n\t\t\tis3D={is3D}\n\t\t\tisTopView={!isSideView}\n\t\t\tanimationCounter={animationCounter}\n\t\t>\n\t\t\t{children}\n\t\t</Map>\n\t);\n};\n\nexport type { Props as GameMapProps };\nexport default GameMap;\n","import usePlayerEvents from 'store/redux/hooks/usePlayerEvents';\nimport GameContainer from './GameContainer';\nimport GameSettings from './GameSettings';\nimport GameContent from './GameContent';\nimport GameMap from './GameMap';\nimport { GameApi } from './types';\n\nconst useGameProps = (props: GameApi) => {\n\tconst {\n\t\tstate: { is3D, gameMap, isSideView, animationCounter, config },\n\t\t// provider,\n\t\tgameId,\n\t\ttype,\n\t} = props;\n\n\tconst gameContainerProps = {\n\t\tis3D,\n\t};\n\n\tconst gameSettingProps = {\n\t\t...props,\n\t\ttype,\n\t};\n\n\tconst gameMapProps = {\n\t\tsizes: config.sizes,\n\t\tgameMap,\n\t\tis3D,\n\t\tisSideView,\n\t\tanimationCounter,\n\t};\n\n\tconst gameContentProps = {\n\t\t...props,\n\t\tgameId,\n\t};\n\n\treturn {\n\t\tgameContainerProps,\n\t\tgameSettingProps,\n\t\tgameMapProps,\n\t\tgameContentProps,\n\t};\n};\n\nconst Game = (props: GameApi) => {\n\tconst playerIntervals = usePlayerEvents(props);\n\tconst {\n\t\tgameContainerProps,\n\t\tgameSettingProps,\n\t\tgameMapProps,\n\t\tgameContentProps,\n\t} = useGameProps(props);\n\n\treturn (\n\t\t<GameContainer {...gameContainerProps}>\n\t\t\t<GameSettings {...gameSettingProps} />\n\t\t\t<GameMap {...gameMapProps}>\n\t\t\t\t<GameContent {...gameContentProps} />\n\t\t\t</GameMap>\n\t\t\t{playerIntervals}\n\t\t</GameContainer>\n\t);\n};\n\nexport default Game;\n"],"sourceRoot":""}